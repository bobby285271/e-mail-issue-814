/* MessageListItem.c generated by valac 0.56.3, the Vala compiler
 * generated from MessageListItem.vala, do not modify */

/* -*- Mode: vala; indent-tabs-mode: nil; tab-width: 4 -*-*/
/*-
 * Copyright (c) 2017 elementary LLC. (https://elementary.io)
 *
 * This program is free software: you can redistribute it and/or modify
 * it under the terms of the GNU General Public License as published by
 * the Free Software Foundation, either version 3 of the License, or
 * (at your option) any later version.
 *
 * This program is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 * GNU General Public License for more details.
 *
 * You should have received a copy of the GNU General Public License
 * along with this program.  If not, see <http://www.gnu.org/licenses/>.
 *
 * Authored by: Corentin Noël <corentin@elementary.io>
 */

#include <gtk/gtk.h>
#include <glib-object.h>
#include <glib.h>
#include <camel/camel.h>
#include <webkit2/webkit2.h>
#include <gio/gio.h>
#include <handy.h>
#include <stdlib.h>
#include <string.h>
#include <gee.h>
#include <gdk-pixbuf/gdk-pixbuf.h>
#include <glib/gi18n-lib.h>
#include <granite.h>
#include <gdk/gdk.h>
#include <float.h>
#include <math.h>
#include <pango/pango.h>

#if !defined(VALA_EXTERN)
#if defined(_MSC_VER)
#define VALA_EXTERN __declspec(dllexport) extern
#elif __GNUC__ >= 4
#define VALA_EXTERN __attribute__((visibility("default"))) extern
#else
#define VALA_EXTERN extern
#endif
#endif

#define MAIL_TYPE_MESSAGE_LIST_ITEM (mail_message_list_item_get_type ())
#define MAIL_MESSAGE_LIST_ITEM(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), MAIL_TYPE_MESSAGE_LIST_ITEM, MailMessageListItem))
#define MAIL_MESSAGE_LIST_ITEM_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), MAIL_TYPE_MESSAGE_LIST_ITEM, MailMessageListItemClass))
#define MAIL_IS_MESSAGE_LIST_ITEM(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), MAIL_TYPE_MESSAGE_LIST_ITEM))
#define MAIL_IS_MESSAGE_LIST_ITEM_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), MAIL_TYPE_MESSAGE_LIST_ITEM))
#define MAIL_MESSAGE_LIST_ITEM_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), MAIL_TYPE_MESSAGE_LIST_ITEM, MailMessageListItemClass))

typedef struct _MailMessageListItem MailMessageListItem;
typedef struct _MailMessageListItemClass MailMessageListItemClass;
typedef struct _MailMessageListItemPrivate MailMessageListItemPrivate;

#define MAIL_TYPE_WEB_VIEW (mail_web_view_get_type ())
#define MAIL_WEB_VIEW(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), MAIL_TYPE_WEB_VIEW, MailWebView))
#define MAIL_WEB_VIEW_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), MAIL_TYPE_WEB_VIEW, MailWebViewClass))
#define MAIL_IS_WEB_VIEW(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), MAIL_TYPE_WEB_VIEW))
#define MAIL_IS_WEB_VIEW_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), MAIL_TYPE_WEB_VIEW))
#define MAIL_WEB_VIEW_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), MAIL_TYPE_WEB_VIEW, MailWebViewClass))

typedef struct _MailWebView MailWebView;
typedef struct _MailWebViewClass MailWebViewClass;

#define MAIL_TYPE_ATTACHMENT_BAR (mail_attachment_bar_get_type ())
#define MAIL_ATTACHMENT_BAR(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), MAIL_TYPE_ATTACHMENT_BAR, MailAttachmentBar))
#define MAIL_ATTACHMENT_BAR_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), MAIL_TYPE_ATTACHMENT_BAR, MailAttachmentBarClass))
#define MAIL_IS_ATTACHMENT_BAR(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), MAIL_TYPE_ATTACHMENT_BAR))
#define MAIL_IS_ATTACHMENT_BAR_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), MAIL_TYPE_ATTACHMENT_BAR))
#define MAIL_ATTACHMENT_BAR_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), MAIL_TYPE_ATTACHMENT_BAR, MailAttachmentBarClass))

typedef struct _MailAttachmentBar MailAttachmentBar;
typedef struct _MailAttachmentBarClass MailAttachmentBarClass;
enum  {
	MAIL_MESSAGE_LIST_ITEM_0_PROPERTY,
	MAIL_MESSAGE_LIST_ITEM_LOADED_PROPERTY,
	MAIL_MESSAGE_LIST_ITEM_MESSAGE_INFO_PROPERTY,
	MAIL_MESSAGE_LIST_ITEM_MIME_MESSAGE_PROPERTY,
	MAIL_MESSAGE_LIST_ITEM_EXPANDED_PROPERTY,
	MAIL_MESSAGE_LIST_ITEM_NUM_PROPERTIES
};
static GParamSpec* mail_message_list_item_properties[MAIL_MESSAGE_LIST_ITEM_NUM_PROPERTIES];
#define _g_object_unref0(var) ((var == NULL) ? NULL : (var = (g_object_unref (var), NULL)))
#define _g_free0(var) (var = (g_free (var), NULL))
typedef enum  {
	MAIL_COMPOSER_WIDGET_TYPE_REPLY,
	MAIL_COMPOSER_WIDGET_TYPE_REPLY_ALL,
	MAIL_COMPOSER_WIDGET_TYPE_FORWARD,
	MAIL_COMPOSER_WIDGET_TYPE_DRAFT
} MailComposerWidgetType;

#define MAIL_COMPOSER_WIDGET_TYPE_TYPE (mail_composer_widget_type_get_type ())

#define MAIL_TYPE_MESSAGE_LIST_BOX (mail_message_list_box_get_type ())
#define MAIL_MESSAGE_LIST_BOX(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), MAIL_TYPE_MESSAGE_LIST_BOX, MailMessageListBox))
#define MAIL_MESSAGE_LIST_BOX_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), MAIL_TYPE_MESSAGE_LIST_BOX, MailMessageListBoxClass))
#define MAIL_IS_MESSAGE_LIST_BOX(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), MAIL_TYPE_MESSAGE_LIST_BOX))
#define MAIL_IS_MESSAGE_LIST_BOX_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), MAIL_TYPE_MESSAGE_LIST_BOX))
#define MAIL_MESSAGE_LIST_BOX_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), MAIL_TYPE_MESSAGE_LIST_BOX, MailMessageListBoxClass))

typedef struct _MailMessageListBox MailMessageListBox;
typedef struct _MailMessageListBoxClass MailMessageListBoxClass;
#define _g_regex_unref0(var) ((var == NULL) ? NULL : (var = (g_regex_unref (var), NULL)))
#define _g_error_free0(var) ((var == NULL) ? NULL : (var = (g_error_free (var), NULL)))
typedef struct _Block31Data Block31Data;
typedef struct _MailMessageListItemGetMessageData MailMessageListItemGetMessageData;
typedef struct _MailMessageListItemOpenMessageData MailMessageListItemOpenMessageData;
#define _camel_content_type_unref0(var) ((var == NULL) ? NULL : (var = (camel_content_type_unref (var), NULL)))
typedef struct _MailMessageListItemParseMimeContentData MailMessageListItemParseMimeContentData;
typedef struct _MailMessageListItemHandleTextMimeData MailMessageListItemHandleTextMimeData;
#define _g_byte_array_unref0(var) ((var == NULL) ? NULL : (var = (g_byte_array_unref (var), NULL)))
#define _g_bytes_unref0(var) ((var == NULL) ? NULL : (var = (g_bytes_unref (var), NULL)))
typedef struct _MailMessageListItemHandleInlineMimeData MailMessageListItemHandleInlineMimeData;
typedef struct _MailMessageListItemGetMessageBodyHtmlData MailMessageListItemGetMessageBodyHtmlData;
typedef struct _Block32Data Block32Data;
#define _g_date_time_unref0(var) ((var == NULL) ? NULL : (var = (g_date_time_unref (var), NULL)))

#define TYPE_GRAVATAR_ICON (gravatar_icon_get_type ())
#define GRAVATAR_ICON(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), TYPE_GRAVATAR_ICON, GravatarIcon))
#define GRAVATAR_ICON_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), TYPE_GRAVATAR_ICON, GravatarIconClass))
#define IS_GRAVATAR_ICON(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), TYPE_GRAVATAR_ICON))
#define IS_GRAVATAR_ICON_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), TYPE_GRAVATAR_ICON))
#define GRAVATAR_ICON_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), TYPE_GRAVATAR_ICON, GravatarIconClass))

typedef struct _GravatarIcon GravatarIcon;
typedef struct _GravatarIconClass GravatarIconClass;

struct _MailMessageListItem {
	GtkListBoxRow parent_instance;
	MailMessageListItemPrivate * priv;
};

struct _MailMessageListItemClass {
	GtkListBoxRowClass parent_class;
};

struct _MailMessageListItemPrivate {
	gboolean _loaded;
	CamelMessageInfo* _message_info;
	CamelMimeMessage* _mime_message;
	MailWebView* web_view;
	GCancellable* loading_cancellable;
	GtkInfoBar* blocked_images_infobar;
	GtkRevealer* secondary_revealer;
	GtkStack* header_stack;
	GtkStyleContext* style_context;
	HdyAvatar* avatar;
	MailAttachmentBar* attachment_bar;
	gchar* message_content;
	gboolean message_is_html;
	gboolean message_loaded;
	GSettings* settings;
};

struct _Block31Data {
	int _ref_count_;
	MailMessageListItem* self;
	gchar** whitelist;
	gint whitelist_length1;
	gint _whitelist_size_;
	const gchar* sender;
};

struct _MailMessageListItemGetMessageData {
	int _state_;
	GObject* _source_object_;
	GAsyncResult* _res_;
	GTask* _async_result;
	MailMessageListItem* self;
	CamelFolder* folder;
	CamelMessageInfo* _tmp0_;
	CamelFolderSummary* _tmp1_;
	CamelFolderSummary* _tmp2_;
	CamelFolderSummary* _tmp3_;
	CamelFolder* _tmp4_;
	CamelFolder* _tmp5_;
	CamelFolder* _tmp6_;
	CamelFolder* _tmp7_;
	CamelMimeMessage* message;
	CamelMimeMessage* _tmp8_;
	CamelFolder* _tmp9_;
	CamelMessageInfo* _tmp10_;
	const gchar* _tmp11_;
	const gchar* _tmp12_;
	GCancellable* _tmp13_;
	CamelMimeMessage* _tmp14_;
	CamelMimeMessage* _tmp15_;
	GError* e;
	GError* _tmp16_;
	const gchar* _tmp17_;
	MailAttachmentBar* _tmp18_;
	MailAttachmentBar* _tmp19_;
	CamelMimeMessage* _tmp20_;
	CamelDataWrapper* _tmp21_;
	CamelDataWrapper* _tmp22_;
	CamelFolderFlags flags;
	CamelFolder* _tmp23_;
	gboolean _tmp24_;
	GSettings* _tmp25_;
	MailWebView* _tmp26_;
	CamelMimeMessage* _tmp27_;
	Block31Data* _data31_;
	GSettings* _tmp28_;
	gchar** _tmp29_;
	gchar** _tmp30_;
	CamelInternetAddress* from;
	CamelMimeMessage* _tmp31_;
	CamelInternetAddress* _tmp32_;
	CamelInternetAddress* _tmp33_;
	CamelInternetAddress* _tmp34_;
	const gchar* _tmp35_;
	const gchar* _tmp36_;
	gchar** _tmp37_;
	gint _tmp37__length1;
	MailWebView* _tmp38_;
	GtkInfoBar* _tmp39_;
	CamelMimeMessage* _tmp40_;
	CamelMimeMessage* _tmp41_;
	CamelMimeMessage* _tmp42_;
	GError* _inner_error0_;
};

struct _MailMessageListItemOpenMessageData {
	int _state_;
	GObject* _source_object_;
	GAsyncResult* _res_;
	GTask* _async_result;
	MailMessageListItem* self;
	CamelMimeMessage* message;
	CamelDataWrapper* _tmp0_;
	CamelDataWrapper* _tmp1_;
	MailWebView* _tmp2_;
	const gchar* _tmp3_;
	CamelMimeFilterToHTMLFlags flags;
	gchar* html;
	const gchar* _tmp4_;
	gchar* _tmp5_;
	MailWebView* _tmp6_;
	const gchar* _tmp7_;
};

struct _MailMessageListItemParseMimeContentData {
	int _state_;
	GObject* _source_object_;
	GAsyncResult* _res_;
	GTask* _async_result;
	MailMessageListItem* self;
	CamelDataWrapper* mime_content;
	CamelMultipart* content;
	CamelMultipart* _tmp0_;
	guint i;
	gboolean _tmp1_;
	guint _tmp2_;
	CamelMultipart* _tmp3_;
	CamelMimePart* part;
	CamelMultipart* _tmp4_;
	CamelMimePart* _tmp5_;
	CamelMimePart* _tmp6_;
	CamelContentType* field;
	CamelMimePart* _tmp7_;
	CamelContentType* _tmp8_;
	CamelContentType* _tmp9_;
	CamelMimePart* _tmp10_;
	const gchar* _tmp11_;
	const gchar* _tmp12_;
	CamelMimePart* _tmp13_;
	CamelContentType* _tmp14_;
	const gchar* _tmp15_;
	CamelMimePart* _tmp16_;
	CamelDataWrapper* _tmp17_;
	CamelDataWrapper* _tmp18_;
	CamelContentType* _tmp19_;
	const gchar* _tmp20_;
	CamelMimePart* _tmp21_;
	CamelDataWrapper* _tmp22_;
	CamelDataWrapper* _tmp23_;
};

struct _MailMessageListItemHandleTextMimeData {
	int _state_;
	GObject* _source_object_;
	GAsyncResult* _res_;
	GTask* _async_result;
	MailMessageListItem* self;
	CamelDataWrapper* part;
	CamelContentType* field;
	CamelContentType* _tmp0_;
	CamelContentType* _tmp1_;
	gboolean _tmp2_;
	const gchar* _tmp3_;
	gboolean _tmp4_;
	CamelContentType* _tmp5_;
	const gchar* _tmp6_;
	GMemoryOutputStream* os;
	GMemoryOutputStream* _tmp7_;
	GMemoryOutputStream* _tmp8_;
	GCancellable* _tmp9_;
	GMemoryOutputStream* _tmp10_;
	GError* e;
	GError* _tmp11_;
	const gchar* _tmp12_;
	GMemoryOutputStream* _tmp13_;
	CamelContentType* _tmp14_;
	const gchar* _tmp15_;
	gchar* _tmp16_;
	CamelContentType* _tmp17_;
	const gchar* _tmp18_;
	GError* _inner_error0_;
};

struct _MailMessageListItemHandleInlineMimeData {
	int _state_;
	GObject* _source_object_;
	GAsyncResult* _res_;
	GTask* _async_result;
	MailMessageListItem* self;
	CamelMimePart* part;
	const gchar* _tmp0_;
	GByteArray* byte_array;
	GByteArray* _tmp1_;
	CamelStreamMem* os;
	CamelStreamMem* _tmp2_;
	CamelStreamMem* _tmp3_;
	GByteArray* _tmp4_;
	GByteArray* _tmp5_;
	CamelDataWrapper* _tmp6_;
	CamelDataWrapper* _tmp7_;
	CamelStreamMem* _tmp8_;
	GCancellable* _tmp9_;
	GError* e;
	GError* _tmp10_;
	const gchar* _tmp11_;
	GBytes* bytes;
	GByteArray* _tmp12_;
	GByteArray* _tmp13_;
	GBytes* _tmp14_;
	GMemoryInputStream* inline_stream;
	GBytes* _tmp15_;
	GMemoryInputStream* _tmp16_;
	MailWebView* _tmp17_;
	const gchar* _tmp18_;
	GMemoryInputStream* _tmp19_;
	GError* _inner_error0_;
};

struct _MailMessageListItemGetMessageBodyHtmlData {
	int _state_;
	GObject* _source_object_;
	GAsyncResult* _res_;
	GTask* _async_result;
	MailMessageListItem* self;
	gchar* result;
	MailWebView* _tmp0_;
	gchar* _tmp1_;
};

struct _Block32Data {
	int _ref_count_;
	MailMessageListItem* self;
	GtkImage* starred_icon;
	GtkMenuButton* actions_menu_button;
	GtkEventBox* header_event_box;
};

static gint MailMessageListItem_private_offset;
static gpointer mail_message_list_item_parent_class = NULL;
static GeeHashMap* mail_message_list_item_avatars;
static GeeHashMap* mail_message_list_item_avatars = NULL;
static GSettings* mail_message_list_item_desktop_settings;
static GSettings* mail_message_list_item_desktop_settings = NULL;

VALA_EXTERN GType mail_message_list_item_get_type (void) G_GNUC_CONST ;
G_DEFINE_AUTOPTR_CLEANUP_FUNC (MailMessageListItem, g_object_unref)
VALA_EXTERN GType mail_web_view_get_type (void) G_GNUC_CONST ;
G_DEFINE_AUTOPTR_CLEANUP_FUNC (MailWebView, g_object_unref)
VALA_EXTERN GType mail_attachment_bar_get_type (void) G_GNUC_CONST ;
G_DEFINE_AUTOPTR_CLEANUP_FUNC (MailAttachmentBar, g_object_unref)
VALA_EXTERN MailMessageListItem* mail_message_list_item_new (CamelMessageInfo* message_info);
VALA_EXTERN MailMessageListItem* mail_message_list_item_construct (GType object_type,
                                                       CamelMessageInfo* message_info);
VALA_EXTERN GType mail_composer_widget_type_get_type (void) G_GNUC_CONST ;
static void mail_message_list_item_add_inline_composer (MailMessageListItem* self,
                                                 MailComposerWidgetType composer_type);
VALA_EXTERN GType mail_message_list_box_get_type (void) G_GNUC_CONST ;
G_DEFINE_AUTOPTR_CLEANUP_FUNC (MailMessageListBox, g_object_unref)
VALA_EXTERN void mail_message_list_box_add_inline_composer (MailMessageListBox* self,
                                                MailComposerWidgetType type,
                                                MailMessageListItem* message_item,
                                                GAsyncReadyCallback _callback_,
                                                gpointer _user_data_);
VALA_EXTERN void mail_message_list_box_add_inline_composer_finish (MailMessageListBox* self,
                                                       GAsyncResult* _res_);
static void mail_message_list_item_on_print (MailMessageListItem* self);
VALA_EXTERN CamelMessageInfo* mail_message_list_item_get_message_info (MailMessageListItem* self);
static void mail_message_list_item_on_mouse_target_changed (MailMessageListItem* self,
                                                     WebKitWebView* web_view,
                                                     WebKitHitTestResult* hit_test,
                                                     guint mods);
static gboolean mail_message_list_item_on_webview_context_menu (MailMessageListItem* self,
                                                         WebKitContextMenu* menu,
                                                         GdkEvent* event,
                                                         WebKitHitTestResult* hit_test);
static void mail_message_list_item_get_message_data_free (gpointer _data);
static void mail_message_list_item_get_message (MailMessageListItem* self,
                                         GAsyncReadyCallback _callback_,
                                         gpointer _user_data_);
static void mail_message_list_item_get_message_finish (MailMessageListItem* self,
                                                GAsyncResult* _res_);
static gboolean mail_message_list_item_get_message_co (MailMessageListItemGetMessageData* _data_);
static void mail_message_list_item_get_message_ready (GObject* source_object,
                                               GAsyncResult* _res_,
                                               gpointer _user_data_);
VALA_EXTERN void mail_attachment_bar_parse_mime_content (MailAttachmentBar* self,
                                             CamelDataWrapper* message_content,
                                             GAsyncReadyCallback _callback_,
                                             gpointer _user_data_);
VALA_EXTERN void mail_attachment_bar_parse_mime_content_finish (MailAttachmentBar* self,
                                                    GAsyncResult* _res_);
VALA_EXTERN void mail_web_view_load_images (MailWebView* self);
static Block31Data* block31_data_ref (Block31Data* _data31_);
static void block31_data_unref (void * _userdata_);
static gboolean _vala_string_array_contains (gchar* * stack,
                                      gssize stack_length,
                                      const gchar* needle);
static void ____lambda81_ (Block31Data* _data31_,
                    gint id);
static void _vala_array_add8 (gchar** * array,
                       gint* length,
                       gint* size,
                       gchar* value);
static void _____lambda81__gtk_info_bar_response (GtkInfoBar* _sender,
                                           gint response_id,
                                           gpointer self);
static void mail_message_list_item_set_mime_message (MailMessageListItem* self,
                                              CamelMimeMessage* value);
static void mail_message_list_item_open_message (MailMessageListItem* self,
                                          CamelMimeMessage* message,
                                          GAsyncReadyCallback _callback_,
                                          gpointer _user_data_);
static void mail_message_list_item_open_message_finish (MailMessageListItem* self,
                                                 GAsyncResult* _res_);
static void mail_message_list_item_open_message_data_free (gpointer _data);
static gboolean mail_message_list_item_open_message_co (MailMessageListItemOpenMessageData* _data_);
static void mail_message_list_item_parse_mime_content (MailMessageListItem* self,
                                                CamelDataWrapper* mime_content,
                                                GAsyncReadyCallback _callback_,
                                                gpointer _user_data_);
static void mail_message_list_item_parse_mime_content_finish (MailMessageListItem* self,
                                                       GAsyncResult* _res_);
static void mail_message_list_item_open_message_ready (GObject* source_object,
                                                GAsyncResult* _res_,
                                                gpointer _user_data_);
VALA_EXTERN void mail_web_view_load_html (MailWebView* self,
                              const gchar* body);
static void mail_message_list_item_parse_mime_content_data_free (gpointer _data);
static gboolean mail_message_list_item_parse_mime_content_co (MailMessageListItemParseMimeContentData* _data_);
static void mail_message_list_item_handle_inline_mime (MailMessageListItem* self,
                                                CamelMimePart* part,
                                                GAsyncReadyCallback _callback_,
                                                gpointer _user_data_);
static void mail_message_list_item_handle_inline_mime_finish (MailMessageListItem* self,
                                                       GAsyncResult* _res_);
static void mail_message_list_item_parse_mime_content_ready (GObject* source_object,
                                                      GAsyncResult* _res_,
                                                      gpointer _user_data_);
static void mail_message_list_item_handle_text_mime (MailMessageListItem* self,
                                              CamelDataWrapper* part,
                                              GAsyncReadyCallback _callback_,
                                              gpointer _user_data_);
static void mail_message_list_item_handle_text_mime_finish (MailMessageListItem* self,
                                                     GAsyncResult* _res_);
static void mail_message_list_item_handle_text_mime_data_free (gpointer _data);
static gboolean mail_message_list_item_handle_text_mime_co (MailMessageListItemHandleTextMimeData* _data_);
static void mail_message_list_item_handle_text_mime_ready (GObject* source_object,
                                                    GAsyncResult* _res_,
                                                    gpointer _user_data_);
static gchar* mail_message_list_item_convert_to_utf8 (GMemoryOutputStream* os,
                                               const gchar* encoding);
static void mail_message_list_item_handle_inline_mime_data_free (gpointer _data);
static gboolean mail_message_list_item_handle_inline_mime_co (MailMessageListItemHandleInlineMimeData* _data_);
static void mail_message_list_item_handle_inline_mime_ready (GObject* source_object,
                                                      GAsyncResult* _res_,
                                                      gpointer _user_data_);
VALA_EXTERN void mail_web_view_add_internal_resource (MailWebView* self,
                                          const gchar* name,
                                          GInputStream* data);
static void mail_message_list_item_get_message_body_html_data_free (gpointer _data);
VALA_EXTERN void mail_message_list_item_get_message_body_html (MailMessageListItem* self,
                                                   GAsyncReadyCallback _callback_,
                                                   gpointer _user_data_);
VALA_EXTERN gchar* mail_message_list_item_get_message_body_html_finish (MailMessageListItem* self,
                                                            GAsyncResult* _res_);
static gboolean mail_message_list_item_get_message_body_html_co (MailMessageListItemGetMessageBodyHtmlData* _data_);
VALA_EXTERN void mail_web_view_get_body_html (MailWebView* self,
                                  GAsyncReadyCallback _callback_,
                                  gpointer _user_data_);
VALA_EXTERN gchar* mail_web_view_get_body_html_finish (MailWebView* self,
                                           GAsyncResult* _res_);
static void mail_message_list_item_get_message_body_html_ready (GObject* source_object,
                                                         GAsyncResult* _res_,
                                                         gpointer _user_data_);
VALA_EXTERN gboolean mail_message_list_item_get_loaded (MailMessageListItem* self);
static void mail_message_list_item_set_loaded (MailMessageListItem* self,
                                        gboolean value);
static void mail_message_list_item_set_message_info (MailMessageListItem* self,
                                              CamelMessageInfo* value);
VALA_EXTERN CamelMimeMessage* mail_message_list_item_get_mime_message (MailMessageListItem* self);
VALA_EXTERN gboolean mail_message_list_item_get_expanded (MailMessageListItem* self);
VALA_EXTERN void mail_message_list_item_set_expanded (MailMessageListItem* self,
                                          gboolean value);
static GObject * mail_message_list_item_constructor (GType type,
                                              guint n_construct_properties,
                                              GObjectConstructParam * construct_properties);
static Block32Data* block32_data_ref (Block32Data* _data32_);
static void block32_data_unref (void * _userdata_);
static void _mail_message_list_item___lambda82_ (MailMessageListItem* self);
static void __mail_message_list_item___lambda82__gtk_menu_item_activate (GtkMenuItem* _sender,
                                                                  gpointer self);
static void _mail_message_list_item___lambda83_ (MailMessageListItem* self);
static void __mail_message_list_item___lambda83__gtk_menu_item_activate (GtkMenuItem* _sender,
                                                                  gpointer self);
static void _mail_message_list_item___lambda84_ (MailMessageListItem* self);
static void __mail_message_list_item___lambda84__gtk_menu_item_activate (GtkMenuItem* _sender,
                                                                  gpointer self);
static void _mail_message_list_item_on_print_gtk_menu_item_activate (GtkMenuItem* _sender,
                                                              gpointer self);
VALA_EXTERN MailWebView* mail_web_view_new (void);
VALA_EXTERN MailWebView* mail_web_view_construct (GType object_type);
static void _mail_message_list_item_on_mouse_target_changed_webkit_web_view_mouse_target_changed (WebKitWebView* _sender,
                                                                                           WebKitHitTestResult* hit_test_result,
                                                                                           guint modifiers,
                                                                                           gpointer self);
static gboolean _mail_message_list_item_on_webview_context_menu_webkit_web_view_context_menu (WebKitWebView* _sender,
                                                                                       WebKitContextMenu* context_menu,
                                                                                       GdkEvent* event,
                                                                                       WebKitHitTestResult* hit_test_result,
                                                                                       gpointer self);
static void _mail_message_list_item___lambda85_ (MailMessageListItem* self);
static void __mail_message_list_item___lambda85__mail_web_view_load_finished (MailWebView* _sender,
                                                                       gpointer self);
VALA_EXTERN MailAttachmentBar* mail_attachment_bar_new (GCancellable* loading_cancellable);
VALA_EXTERN MailAttachmentBar* mail_attachment_bar_construct (GType object_type,
                                                  GCancellable* loading_cancellable);
VALA_EXTERN GravatarIcon* gravatar_icon_new (const gchar* address,
                                 gint scale);
VALA_EXTERN GravatarIcon* gravatar_icon_construct (GType object_type,
                                       const gchar* address,
                                       gint scale);
VALA_EXTERN GType gravatar_icon_get_type (void) G_GNUC_CONST ;
G_DEFINE_AUTOPTR_CLEANUP_FUNC (GravatarIcon, g_object_unref)
static gboolean _mail_message_list_item___lambda86_ (Block32Data* _data32_,
                                              GdkEventButton* event);
static gboolean __mail_message_list_item___lambda86__gtk_widget_button_release_event (GtkWidget* _sender,
                                                                               GdkEventButton* event,
                                                                               gpointer self);
static gboolean _mail_message_list_item___lambda87_ (Block32Data* _data32_,
                                              GdkEventCrossing* event);
static gboolean __mail_message_list_item___lambda87__gtk_widget_enter_notify_event (GtkWidget* _sender,
                                                                             GdkEventCrossing* event,
                                                                             gpointer self);
static gboolean _mail_message_list_item___lambda88_ (Block32Data* _data32_,
                                              GdkEventCrossing* event);
static gboolean __mail_message_list_item___lambda88__gtk_widget_leave_notify_event (GtkWidget* _sender,
                                                                             GdkEventCrossing* event,
                                                                             gpointer self);
static gboolean _mail_message_list_item___lambda89_ (MailMessageListItem* self,
                                              GdkEventButton* event);
static gboolean __mail_message_list_item___lambda89__gtk_widget_button_release_event (GtkWidget* _sender,
                                                                               GdkEventButton* event,
                                                                               gpointer self);
static void _mail_message_list_item___lambda90_ (MailMessageListItem* self);
static void __mail_message_list_item___lambda90__gtk_widget_destroy (GtkWidget* _sender,
                                                              gpointer self);
static gboolean _mail_message_list_item___lambda91_ (Block32Data* _data32_);
static gboolean __mail_message_list_item___lambda91__gtk_widget_button_release_event (GtkWidget* _sender,
                                                                               GdkEventButton* event,
                                                                               gpointer self);
static void _mail_message_list_item___lambda92_ (MailMessageListItem* self);
static void __mail_message_list_item___lambda92__mail_web_view_image_load_blocked (MailWebView* _sender,
                                                                            gpointer self);
static void _mail_message_list_item___lambda93_ (MailMessageListItem* self,
                                          const gchar* uri);
static void __mail_message_list_item___lambda93__mail_web_view_link_activated (MailWebView* _sender,
                                                                        const gchar* url,
                                                                        gpointer self);
static void mail_message_list_item_finalize (GObject * obj);
static GType mail_message_list_item_get_type_once (void);
static void _vala_mail_message_list_item_get_property (GObject * object,
                                                guint property_id,
                                                GValue * value,
                                                GParamSpec * pspec);
static void _vala_mail_message_list_item_set_property (GObject * object,
                                                guint property_id,
                                                const GValue * value,
                                                GParamSpec * pspec);
static void _vala_array_destroy (gpointer array,
                          gssize array_length,
                          GDestroyNotify destroy_func);
static void _vala_array_free (gpointer array,
                       gssize array_length,
                       GDestroyNotify destroy_func);
static gssize _vala_array_length (gpointer array);

static inline gpointer
mail_message_list_item_get_instance_private (MailMessageListItem* self)
{
	return G_STRUCT_MEMBER_P (self, MailMessageListItem_private_offset);
}

MailMessageListItem*
mail_message_list_item_construct (GType object_type,
                                  CamelMessageInfo* message_info)
{
	MailMessageListItem * self = NULL;
	g_return_val_if_fail (message_info != NULL, NULL);
	self = (MailMessageListItem*) g_object_new (object_type, "margin", 12, "message-info", message_info, NULL);
	return self;
}

MailMessageListItem*
mail_message_list_item_new (CamelMessageInfo* message_info)
{
	return mail_message_list_item_construct (MAIL_TYPE_MESSAGE_LIST_ITEM, message_info);
}

static gpointer
_g_object_ref0 (gpointer self)
{
	return self ? g_object_ref (self) : NULL;
}

static void
mail_message_list_item_add_inline_composer (MailMessageListItem* self,
                                            MailComposerWidgetType composer_type)
{
	MailMessageListBox* message_list_box = NULL;
	GtkContainer* _tmp0_;
	MailMessageListBox* _tmp1_;
	g_return_if_fail (self != NULL);
	_tmp0_ = gtk_widget_get_parent ((GtkWidget*) self);
	_tmp1_ = _g_object_ref0 (G_TYPE_CHECK_INSTANCE_CAST (_tmp0_, MAIL_TYPE_MESSAGE_LIST_BOX, MailMessageListBox));
	message_list_box = _tmp1_;
	mail_message_list_box_add_inline_composer (message_list_box, composer_type, self, NULL, NULL);
	_g_object_unref0 (message_list_box);
}

static gchar*
string_strip (const gchar* self)
{
	gchar* _result_ = NULL;
	gchar* _tmp0_;
	gchar* result;
	g_return_val_if_fail (self != NULL, NULL);
	_tmp0_ = g_strdup (self);
	_result_ = _tmp0_;
	g_strstrip (_result_);
	result = _result_;
	return result;
}

static glong
string_strnlen (gchar* str,
                glong maxlen)
{
	gchar* end = NULL;
	gchar* _tmp0_;
	gchar* _tmp1_;
	glong result;
	_tmp0_ = memchr (str, 0, (gsize) maxlen);
	end = _tmp0_;
	_tmp1_ = end;
	if (_tmp1_ == NULL) {
		result = maxlen;
		return result;
	} else {
		gchar* _tmp2_;
		_tmp2_ = end;
		result = (glong) (_tmp2_ - str);
		return result;
	}
}

static gchar*
string_substring (const gchar* self,
                  glong offset,
                  glong len)
{
	glong string_length = 0L;
	gboolean _tmp0_ = FALSE;
	gchar* _tmp3_;
	gchar* result;
	g_return_val_if_fail (self != NULL, NULL);
	if (offset >= ((glong) 0)) {
		_tmp0_ = len >= ((glong) 0);
	} else {
		_tmp0_ = FALSE;
	}
	if (_tmp0_) {
		string_length = string_strnlen ((gchar*) self, offset + len);
	} else {
		gint _tmp1_;
		gint _tmp2_;
		_tmp1_ = strlen (self);
		_tmp2_ = _tmp1_;
		string_length = (glong) _tmp2_;
	}
	if (offset < ((glong) 0)) {
		offset = string_length + offset;
		g_return_val_if_fail (offset >= ((glong) 0), NULL);
	} else {
		g_return_val_if_fail (offset <= string_length, NULL);
	}
	if (len < ((glong) 0)) {
		len = string_length - offset;
	}
	g_return_val_if_fail ((offset + len) <= string_length, NULL);
	_tmp3_ = g_strndup (((gchar*) self) + offset, (gsize) len);
	result = _tmp3_;
	return result;
}

static void
mail_message_list_item_on_print (MailMessageListItem* self)
{
	GError* _inner_error0_ = NULL;
	g_return_if_fail (self != NULL);
	{
		GtkPrintSettings* settings = NULL;
		GtkPrintSettings* _tmp0_;
		gchar* filename = NULL;
		gchar* _tmp1_;
		const gchar* subject = NULL;
		CamelMessageInfo* _tmp2_;
		const gchar* _tmp3_;
		const gchar* _tmp4_;
		gboolean _tmp5_ = FALSE;
		const gchar* _tmp6_;
		GtkPrintSettings* _tmp24_;
		const gchar* _tmp25_;
		WebKitPrintOperation* print_operation = NULL;
		MailWebView* _tmp26_;
		WebKitPrintOperation* _tmp27_;
		WebKitPrintOperation* _tmp28_;
		GtkPrintSettings* _tmp29_;
		WebKitPrintOperation* _tmp30_;
		GtkWidget* _tmp31_;
		_tmp0_ = gtk_print_settings_new ();
		settings = _tmp0_;
		_tmp1_ = g_strdup (_ ("Email Message"));
		filename = _tmp1_;
		_tmp2_ = self->priv->_message_info;
		_tmp3_ = camel_message_info_get_subject (_tmp2_);
		_tmp4_ = _tmp3_;
		subject = _tmp4_;
		_tmp6_ = subject;
		if (_tmp6_ != NULL) {
			const gchar* _tmp7_;
			_tmp7_ = subject;
			_tmp5_ = g_strcmp0 (_tmp7_, "") != 0;
		} else {
			_tmp5_ = FALSE;
		}
		if (_tmp5_) {
			GRegex* _tmp8_ = NULL;
			GRegex* _tmp9_;
			gchar* _tmp10_ = NULL;
			const gchar* _tmp11_;
			gchar* _tmp12_;
			gchar* sanitized_subject = NULL;
			gchar* _tmp13_;
			const gchar* _tmp14_;
			gint _tmp15_;
			gint _tmp16_;
			_tmp9_ = g_regex_new ("[[:space:][:cntrl:]/]+", 0, 0, &_inner_error0_);
			_tmp8_ = _tmp9_;
			if (G_UNLIKELY (_inner_error0_ != NULL)) {
				_g_free0 (filename);
				_g_object_unref0 (settings);
				goto __catch0_g_error;
			}
			_tmp11_ = subject;
			_tmp12_ = g_regex_replace (_tmp8_, _tmp11_, (gssize) -1, 0, " ", 0, &_inner_error0_);
			_tmp10_ = _tmp12_;
			if (G_UNLIKELY (_inner_error0_ != NULL)) {
				_g_regex_unref0 (_tmp8_);
				_g_free0 (filename);
				_g_object_unref0 (settings);
				goto __catch0_g_error;
			}
			_tmp13_ = string_strip (_tmp10_);
			sanitized_subject = _tmp13_;
			_tmp14_ = sanitized_subject;
			_tmp15_ = strlen (_tmp14_);
			_tmp16_ = _tmp15_;
			if (_tmp16_ <= 64) {
				const gchar* _tmp17_;
				gchar* _tmp18_;
				_tmp17_ = sanitized_subject;
				_tmp18_ = g_strdup (_tmp17_);
				_g_free0 (filename);
				filename = _tmp18_;
			} else {
				const gchar* _tmp19_;
				const gchar* _tmp20_;
				gchar* _tmp21_;
				gchar* _tmp22_;
				gchar* _tmp23_;
				_tmp19_ = sanitized_subject;
				_tmp20_ = sanitized_subject;
				_tmp21_ = string_substring (_tmp19_, (glong) 0, (glong) g_utf8_strlen (_tmp20_, (gssize) (64 - 1)));
				_tmp22_ = _tmp21_;
				_tmp23_ = g_strdup_printf ("%s…", _tmp22_);
				_g_free0 (filename);
				filename = _tmp23_;
				_g_free0 (_tmp22_);
			}
			_g_free0 (sanitized_subject);
			_g_free0 (_tmp10_);
			_g_regex_unref0 (_tmp8_);
		}
		_tmp24_ = settings;
		_tmp25_ = filename;
		gtk_print_settings_set (_tmp24_, GTK_PRINT_SETTINGS_OUTPUT_BASENAME, _tmp25_);
		_tmp26_ = self->priv->web_view;
		_tmp27_ = webkit_print_operation_new ((WebKitWebView*) _tmp26_);
		print_operation = _tmp27_;
		_tmp28_ = print_operation;
		_tmp29_ = settings;
		webkit_print_operation_set_print_settings (_tmp28_, _tmp29_);
		_tmp30_ = print_operation;
		_tmp31_ = gtk_widget_get_toplevel ((GtkWidget*) self);
		webkit_print_operation_run_dialog (_tmp30_, (GtkWindow*) G_TYPE_CHECK_INSTANCE_CAST (_tmp31_, gtk_application_window_get_type (), GtkApplicationWindow));
		_g_object_unref0 (print_operation);
		_g_free0 (filename);
		_g_object_unref0 (settings);
	}
	goto __finally0;
	__catch0_g_error:
	{
		GError* e = NULL;
		GraniteMessageDialog* print_error_dialog = NULL;
		GraniteMessageDialog* _tmp32_;
		GraniteMessageDialog* _tmp33_;
		GThemedIcon* _tmp34_;
		GThemedIcon* _tmp35_;
		GraniteMessageDialog* _tmp36_;
		GtkWidget* _tmp37_;
		GraniteMessageDialog* _tmp38_;
		GError* _tmp39_;
		const gchar* _tmp40_;
		GraniteMessageDialog* _tmp41_;
		GraniteMessageDialog* _tmp42_;
		e = _inner_error0_;
		_inner_error0_ = NULL;
		_tmp32_ = granite_message_dialog_new_with_image_from_icon_name (_ ("Unable to print email"), _ (""), "printer", GTK_BUTTONS_CLOSE);
		g_object_ref_sink (_tmp32_);
		print_error_dialog = _tmp32_;
		_tmp33_ = print_error_dialog;
		_tmp34_ = (GThemedIcon*) g_themed_icon_new ("dialog-error");
		_tmp35_ = _tmp34_;
		granite_message_dialog_set_badge_icon (_tmp33_, (GIcon*) _tmp35_);
		_g_object_unref0 (_tmp35_);
		_tmp36_ = print_error_dialog;
		_tmp37_ = gtk_widget_get_toplevel ((GtkWidget*) self);
		gtk_window_set_transient_for ((GtkWindow*) _tmp36_, G_TYPE_CHECK_INSTANCE_CAST (_tmp37_, gtk_window_get_type (), GtkWindow));
		_tmp38_ = print_error_dialog;
		_tmp39_ = e;
		_tmp40_ = _tmp39_->message;
		granite_message_dialog_show_error_details (_tmp38_, _tmp40_);
		_tmp41_ = print_error_dialog;
		gtk_dialog_run ((GtkDialog*) _tmp41_);
		_tmp42_ = print_error_dialog;
		gtk_widget_destroy ((GtkWidget*) _tmp42_);
		_g_object_unref0 (print_error_dialog);
		_g_error_free0 (e);
	}
	__finally0:
	if (G_UNLIKELY (_inner_error0_ != NULL)) {
		g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _inner_error0_->message, g_quark_to_string (_inner_error0_->domain), _inner_error0_->code);
		g_clear_error (&_inner_error0_);
		return;
	}
}

static void
mail_message_list_item_on_mouse_target_changed (MailMessageListItem* self,
                                                WebKitWebView* web_view,
                                                WebKitHitTestResult* hit_test,
                                                guint mods)
{
	MailMessageListBox* list_box = NULL;
	GtkContainer* _tmp0_;
	GtkContainer* _tmp1_;
	MailMessageListBox* _tmp2_;
	g_return_if_fail (self != NULL);
	g_return_if_fail (web_view != NULL);
	g_return_if_fail (hit_test != NULL);
	_tmp0_ = gtk_widget_get_parent ((GtkWidget*) self);
	_tmp1_ = _tmp0_;
	_tmp2_ = _g_object_ref0 (MAIL_IS_MESSAGE_LIST_BOX (_tmp1_) ? ((MailMessageListBox*) _tmp1_) : NULL);
	list_box = _tmp2_;
	if (webkit_hit_test_result_context_is_link (hit_test)) {
		MailMessageListBox* _tmp3_;
		const gchar* _tmp4_;
		const gchar* _tmp5_;
		_tmp3_ = list_box;
		_tmp4_ = webkit_hit_test_result_get_link_label (hit_test);
		_tmp5_ = webkit_hit_test_result_get_link_uri (hit_test);
		g_signal_emit_by_name (_tmp3_, "hovering-over-link", _tmp4_, _tmp5_);
	} else {
		MailMessageListBox* _tmp6_;
		_tmp6_ = list_box;
		g_signal_emit_by_name (_tmp6_, "hovering-over-link", NULL, NULL);
	}
	_g_object_unref0 (list_box);
}

static gboolean
mail_message_list_item_on_webview_context_menu (MailMessageListItem* self,
                                                WebKitContextMenu* menu,
                                                GdkEvent* event,
                                                WebKitHitTestResult* hit_test)
{
	WebKitContextMenu* new_context_menu = NULL;
	WebKitContextMenu* _tmp0_;
	WebKitContextMenu* _tmp8_;
	GList* _tmp9_;
	WebKitContextMenuItem* _tmp12_;
	WebKitContextMenuItem* _tmp13_;
	gboolean result;
	g_return_val_if_fail (self != NULL, FALSE);
	g_return_val_if_fail (menu != NULL, FALSE);
	g_return_val_if_fail (event != NULL, FALSE);
	g_return_val_if_fail (hit_test != NULL, FALSE);
	_tmp0_ = webkit_context_menu_new ();
	new_context_menu = _tmp0_;
	{
		gint i = 0;
		i = 0;
		{
			gboolean _tmp1_ = FALSE;
			_tmp1_ = TRUE;
			while (TRUE) {
				WebKitContextMenuItem* item = NULL;
				WebKitContextMenuItem* _tmp3_;
				WebKitContextMenuItem* _tmp4_;
				WebKitContextMenuItem* _tmp5_;
				if (!_tmp1_) {
					gint _tmp2_;
					_tmp2_ = i;
					i = _tmp2_ + 1;
				}
				_tmp1_ = FALSE;
				if (!(((guint) i) < webkit_context_menu_get_n_items (menu))) {
					break;
				}
				_tmp3_ = webkit_context_menu_get_item_at_position (menu, (guint) i);
				_tmp4_ = _g_object_ref0 (_tmp3_);
				item = _tmp4_;
				_tmp5_ = item;
				switch (webkit_context_menu_item_get_stock_action (_tmp5_)) {
					case WEBKIT_CONTEXT_MENU_ACTION_COPY_LINK_TO_CLIPBOARD:
					case WEBKIT_CONTEXT_MENU_ACTION_COPY_IMAGE_URL_TO_CLIPBOARD:
					case WEBKIT_CONTEXT_MENU_ACTION_COPY:
					{
						WebKitContextMenu* _tmp6_;
						WebKitContextMenuItem* _tmp7_;
						_tmp6_ = new_context_menu;
						_tmp7_ = item;
						webkit_context_menu_append (_tmp6_, _tmp7_);
						break;
					}
					default:
					{
						break;
					}
				}
				_g_object_unref0 (item);
			}
		}
	}
	webkit_context_menu_remove_all (menu);
	_tmp8_ = new_context_menu;
	_tmp9_ = webkit_context_menu_get_items (_tmp8_);
	{
		GList* item_collection = NULL;
		GList* item_it = NULL;
		item_collection = _tmp9_;
		for (item_it = item_collection; item_it != NULL; item_it = item_it->next) {
			WebKitContextMenuItem* _tmp10_;
			WebKitContextMenuItem* item = NULL;
			_tmp10_ = _g_object_ref0 ((WebKitContextMenuItem*) item_it->data);
			item = _tmp10_;
			{
				WebKitContextMenuItem* _tmp11_;
				_tmp11_ = item;
				webkit_context_menu_append (menu, _tmp11_);
				_g_object_unref0 (item);
			}
		}
	}
	_tmp12_ = webkit_context_menu_item_new_from_stock_action (WEBKIT_CONTEXT_MENU_ACTION_SELECT_ALL);
	g_object_ref_sink (_tmp12_);
	_tmp13_ = _tmp12_;
	webkit_context_menu_append (menu, _tmp13_);
	_g_object_unref0 (_tmp13_);
	result = FALSE;
	_g_object_unref0 (new_context_menu);
	return result;
}

static void
mail_message_list_item_get_message_data_free (gpointer _data)
{
	MailMessageListItemGetMessageData* _data_;
	_data_ = _data;
	_g_object_unref0 (_data_->self);
	g_slice_free (MailMessageListItemGetMessageData, _data_);
}

static void
mail_message_list_item_get_message (MailMessageListItem* self,
                                    GAsyncReadyCallback _callback_,
                                    gpointer _user_data_)
{
	MailMessageListItemGetMessageData* _data_;
	MailMessageListItem* _tmp0_;
	g_return_if_fail (self != NULL);
	_data_ = g_slice_new0 (MailMessageListItemGetMessageData);
	_data_->_async_result = g_task_new (G_OBJECT (self), NULL, _callback_, _user_data_);
	g_task_set_task_data (_data_->_async_result, _data_, mail_message_list_item_get_message_data_free);
	_tmp0_ = _g_object_ref0 (self);
	_data_->self = _tmp0_;
	mail_message_list_item_get_message_co (_data_);
}

static void
mail_message_list_item_get_message_finish (MailMessageListItem* self,
                                           GAsyncResult* _res_)
{
	MailMessageListItemGetMessageData* _data_;
	_data_ = g_task_propagate_pointer (G_TASK (_res_), NULL);
}

static void
mail_message_list_item_get_message_ready (GObject* source_object,
                                          GAsyncResult* _res_,
                                          gpointer _user_data_)
{
	MailMessageListItemGetMessageData* _data_;
	_data_ = _user_data_;
	_data_->_source_object_ = source_object;
	_data_->_res_ = _res_;
	mail_message_list_item_get_message_co (_data_);
}

static Block31Data*
block31_data_ref (Block31Data* _data31_)
{
	g_atomic_int_inc (&_data31_->_ref_count_);
	return _data31_;
}

static void
block31_data_unref (void * _userdata_)
{
	Block31Data* _data31_;
	_data31_ = (Block31Data*) _userdata_;
	if (g_atomic_int_dec_and_test (&_data31_->_ref_count_)) {
		MailMessageListItem* self;
		self = _data31_->self;
		_data31_->whitelist = (_vala_array_free (_data31_->whitelist, _data31_->whitelist_length1, (GDestroyNotify) g_free), NULL);
		_g_object_unref0 (self);
		g_slice_free (Block31Data, _data31_);
	}
}

static gboolean
_vala_string_array_contains (gchar* * stack,
                             gssize stack_length,
                             const gchar* needle)
{
	gssize i;
	for (i = 0; i < stack_length; i++) {
		if (g_strcmp0 (stack[i], needle) == 0) {
			return TRUE;
		}
	}
	return FALSE;
}

static void
_vala_array_add8 (gchar** * array,
                  gint* length,
                  gint* size,
                  gchar* value)
{
	if ((*length) == (*size)) {
		*size = (*size) ? (2 * (*size)) : 4;
		*array = g_renew (gchar*, *array, (*size) + 1);
	}
	(*array)[(*length)++] = value;
	(*array)[*length] = NULL;
}

static void
____lambda81_ (Block31Data* _data31_,
               gint id)
{
	MailMessageListItem* self;
	MailWebView* _tmp6_;
	GtkInfoBar* _tmp7_;
	self = _data31_->self;
	if (id == 2) {
		const gchar* _tmp0_;
		gchar** _tmp1_;
		gint _tmp1__length1;
		_tmp0_ = _data31_->sender;
		_tmp1_ = _data31_->whitelist;
		_tmp1__length1 = _data31_->whitelist_length1;
		if (!_vala_string_array_contains (_tmp1_, _tmp1__length1, _tmp0_)) {
			const gchar* _tmp2_;
			gchar* _tmp3_;
			GSettings* _tmp4_;
			gchar** _tmp5_;
			gint _tmp5__length1;
			_tmp2_ = _data31_->sender;
			_tmp3_ = g_strdup (_tmp2_);
			_vala_array_add8 (&_data31_->whitelist, &_data31_->whitelist_length1, &_data31_->_whitelist_size_, _tmp3_);
			_tmp4_ = self->priv->settings;
			_tmp5_ = _data31_->whitelist;
			_tmp5__length1 = _data31_->whitelist_length1;
			g_settings_set_strv (_tmp4_, "remote-images-whitelist", _tmp5_);
		}
	}
	_tmp6_ = self->priv->web_view;
	mail_web_view_load_images (_tmp6_);
	_tmp7_ = self->priv->blocked_images_infobar;
	gtk_widget_destroy ((GtkWidget*) _tmp7_);
}

static void
_____lambda81__gtk_info_bar_response (GtkInfoBar* _sender,
                                      gint response_id,
                                      gpointer self)
{
	____lambda81_ (self, response_id);
}

static gboolean
mail_message_list_item_get_message_co (MailMessageListItemGetMessageData* _data_)
{
	switch (_data_->_state_) {
		case 0:
		goto _state_0;
		case 1:
		goto _state_1;
		case 2:
		goto _state_2;
		case 3:
		goto _state_3;
		default:
		g_assert_not_reached ();
	}
	_state_0:
	_data_->_tmp0_ = _data_->self->priv->_message_info;
	g_object_get (_data_->_tmp0_, "summary", &_data_->_tmp1_, NULL);
	_data_->_tmp2_ = _data_->_tmp1_;
	_data_->_tmp3_ = _data_->_tmp2_;
	_data_->_tmp4_ = camel_folder_summary_get_folder (_data_->_tmp3_);
	_data_->_tmp5_ = _data_->_tmp4_;
	_data_->_tmp6_ = _g_object_ref0 (_data_->_tmp5_);
	_data_->_tmp7_ = _data_->_tmp6_;
	_g_object_unref0 (_data_->_tmp3_);
	_data_->folder = _data_->_tmp7_;
	_data_->message = NULL;
	{
		_data_->_tmp9_ = _data_->folder;
		_data_->_tmp10_ = _data_->self->priv->_message_info;
		_data_->_tmp11_ = camel_message_info_get_uid (_data_->_tmp10_);
		_data_->_tmp12_ = _data_->_tmp11_;
		_data_->_tmp13_ = _data_->self->priv->loading_cancellable;
		_data_->_state_ = 1;
		camel_folder_get_message (_data_->_tmp9_, _data_->_tmp12_, G_PRIORITY_DEFAULT, _data_->_tmp13_, mail_message_list_item_get_message_ready, _data_);
		return FALSE;
		_state_1:
		_data_->_tmp14_ = camel_folder_get_message_finish (_data_->_tmp9_, _data_->_res_, &_data_->_inner_error0_);
		_data_->_tmp8_ = _data_->_tmp14_;
		if (G_UNLIKELY (_data_->_inner_error0_ != NULL)) {
			goto __catch0_g_error;
		}
		_data_->_tmp15_ = _g_object_ref0 (_data_->_tmp8_);
		_g_object_unref0 (_data_->message);
		_data_->message = _data_->_tmp15_;
	}
	goto __finally0;
	__catch0_g_error:
	{
		_data_->e = _data_->_inner_error0_;
		_data_->_inner_error0_ = NULL;
		_data_->_tmp16_ = _data_->e;
		_data_->_tmp17_ = _data_->_tmp16_->message;
		g_warning ("MessageListItem.vala:442: Could not get message. %s", _data_->_tmp17_);
		_g_error_free0 (_data_->e);
	}
	__finally0:
	if (G_UNLIKELY (_data_->_inner_error0_ != NULL)) {
		_g_object_unref0 (_data_->message);
		_g_object_unref0 (_data_->folder);
		g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _data_->_inner_error0_->message, g_quark_to_string (_data_->_inner_error0_->domain), _data_->_inner_error0_->code);
		g_clear_error (&_data_->_inner_error0_);
		g_object_unref (_data_->_async_result);
		return FALSE;
	}
	_data_->_tmp18_ = _data_->self->priv->attachment_bar;
	if (_data_->_tmp18_ != NULL) {
		_data_->_tmp19_ = _data_->self->priv->attachment_bar;
		_data_->_tmp20_ = _data_->message;
		_data_->_tmp21_ = camel_medium_get_content ((CamelMedium*) _data_->_tmp20_);
		_data_->_tmp22_ = _data_->_tmp21_;
		_data_->_state_ = 2;
		mail_attachment_bar_parse_mime_content (_data_->_tmp19_, _data_->_tmp22_, mail_message_list_item_get_message_ready, _data_);
		return FALSE;
		_state_2:
		mail_attachment_bar_parse_mime_content_finish (_data_->_tmp19_, _data_->_res_);
	}
	_data_->_tmp23_ = _data_->folder;
	_data_->flags = (CamelFolderFlags) camel_folder_get_flags (_data_->_tmp23_);
	if (!((_data_->flags & CAMEL_FOLDER_IS_JUNK) == CAMEL_FOLDER_IS_JUNK)) {
		_data_->_tmp25_ = _data_->self->priv->settings;
		_data_->_tmp24_ = g_settings_get_boolean (_data_->_tmp25_, "always-load-remote-images");
	} else {
		_data_->_tmp24_ = FALSE;
	}
	if (_data_->_tmp24_) {
		_data_->_tmp26_ = _data_->self->priv->web_view;
		mail_web_view_load_images (_data_->_tmp26_);
	} else {
		_data_->_tmp27_ = _data_->message;
		if (_data_->_tmp27_ != NULL) {
			_data_->_data31_ = g_slice_new0 (Block31Data);
			_data_->_data31_->_ref_count_ = 1;
			_data_->_data31_->self = g_object_ref (_data_->self);
			_data_->_tmp28_ = _data_->self->priv->settings;
			_data_->_tmp30_ = _data_->_tmp29_ = g_settings_get_strv (_data_->_tmp28_, "remote-images-whitelist");
			_data_->_data31_->whitelist = _data_->_tmp30_;
			_data_->_data31_->whitelist_length1 = _vala_array_length (_data_->_tmp29_);
			_data_->_data31_->_whitelist_size_ = _data_->_data31_->whitelist_length1;
			_data_->_tmp31_ = _data_->message;
			_data_->_tmp32_ = camel_mime_message_get_from (_data_->_tmp31_);
			_data_->from = _data_->_tmp32_;
			_data_->_tmp33_ = _data_->from;
			if (_data_->_tmp33_ == NULL) {
				block31_data_unref (_data_->_data31_);
				_data_->_data31_ = NULL;
				_g_object_unref0 (_data_->message);
				_g_object_unref0 (_data_->folder);
				g_task_return_pointer (_data_->_async_result, _data_, NULL);
				if (_data_->_state_ != 0) {
					while (!g_task_get_completed (_data_->_async_result)) {
						g_main_context_iteration (g_task_get_context (_data_->_async_result), TRUE);
					}
				}
				g_object_unref (_data_->_async_result);
				return FALSE;
			}
			_data_->_tmp34_ = _data_->from;
			_data_->_tmp35_ = NULL;
			camel_internet_address_get (_data_->_tmp34_, 0, NULL, &_data_->_tmp35_);
			_data_->_data31_->sender = _data_->_tmp35_;
			_data_->_tmp36_ = _data_->_data31_->sender;
			_data_->_tmp37_ = _data_->_data31_->whitelist;
			_data_->_tmp37__length1 = _data_->_data31_->whitelist_length1;
			if (_vala_string_array_contains (_data_->_tmp37_, _data_->_tmp37__length1, _data_->_tmp36_)) {
				_data_->_tmp38_ = _data_->self->priv->web_view;
				mail_web_view_load_images (_data_->_tmp38_);
			}
			_data_->_tmp39_ = _data_->self->priv->blocked_images_infobar;
			g_signal_connect_data (_data_->_tmp39_, "response", (GCallback) _____lambda81__gtk_info_bar_response, block31_data_ref (_data_->_data31_), (GClosureNotify) block31_data_unref, 0);
			block31_data_unref (_data_->_data31_);
			_data_->_data31_ = NULL;
		}
	}
	_data_->_tmp40_ = _data_->message;
	if (_data_->_tmp40_ != NULL) {
		_data_->_tmp41_ = _data_->message;
		mail_message_list_item_set_mime_message (_data_->self, _data_->_tmp41_);
		_data_->_tmp42_ = _data_->message;
		_data_->_state_ = 3;
		mail_message_list_item_open_message (_data_->self, _data_->_tmp42_, mail_message_list_item_get_message_ready, _data_);
		return FALSE;
		_state_3:
		mail_message_list_item_open_message_finish (_data_->self, _data_->_res_);
	}
	_g_object_unref0 (_data_->message);
	_g_object_unref0 (_data_->folder);
	g_task_return_pointer (_data_->_async_result, _data_, NULL);
	if (_data_->_state_ != 0) {
		while (!g_task_get_completed (_data_->_async_result)) {
			g_main_context_iteration (g_task_get_context (_data_->_async_result), TRUE);
		}
	}
	g_object_unref (_data_->_async_result);
	return FALSE;
}

static void
mail_message_list_item_open_message_data_free (gpointer _data)
{
	MailMessageListItemOpenMessageData* _data_;
	_data_ = _data;
	_g_object_unref0 (_data_->message);
	_g_object_unref0 (_data_->self);
	g_slice_free (MailMessageListItemOpenMessageData, _data_);
}

static void
mail_message_list_item_open_message (MailMessageListItem* self,
                                     CamelMimeMessage* message,
                                     GAsyncReadyCallback _callback_,
                                     gpointer _user_data_)
{
	MailMessageListItemOpenMessageData* _data_;
	MailMessageListItem* _tmp0_;
	CamelMimeMessage* _tmp1_;
	g_return_if_fail (self != NULL);
	g_return_if_fail (message != NULL);
	_data_ = g_slice_new0 (MailMessageListItemOpenMessageData);
	_data_->_async_result = g_task_new (G_OBJECT (self), NULL, _callback_, _user_data_);
	g_task_set_task_data (_data_->_async_result, _data_, mail_message_list_item_open_message_data_free);
	_tmp0_ = _g_object_ref0 (self);
	_data_->self = _tmp0_;
	_tmp1_ = _g_object_ref0 (message);
	_g_object_unref0 (_data_->message);
	_data_->message = _tmp1_;
	mail_message_list_item_open_message_co (_data_);
}

static void
mail_message_list_item_open_message_finish (MailMessageListItem* self,
                                            GAsyncResult* _res_)
{
	MailMessageListItemOpenMessageData* _data_;
	_data_ = g_task_propagate_pointer (G_TASK (_res_), NULL);
}

static void
mail_message_list_item_open_message_ready (GObject* source_object,
                                           GAsyncResult* _res_,
                                           gpointer _user_data_)
{
	MailMessageListItemOpenMessageData* _data_;
	_data_ = _user_data_;
	_data_->_source_object_ = source_object;
	_data_->_res_ = _res_;
	mail_message_list_item_open_message_co (_data_);
}

static gboolean
mail_message_list_item_open_message_co (MailMessageListItemOpenMessageData* _data_)
{
	switch (_data_->_state_) {
		case 0:
		goto _state_0;
		case 1:
		goto _state_1;
		default:
		g_assert_not_reached ();
	}
	_state_0:
	_data_->_tmp0_ = camel_medium_get_content ((CamelMedium*) _data_->message);
	_data_->_tmp1_ = _data_->_tmp0_;
	_data_->_state_ = 1;
	mail_message_list_item_parse_mime_content (_data_->self, _data_->_tmp1_, mail_message_list_item_open_message_ready, _data_);
	return FALSE;
	_state_1:
	mail_message_list_item_parse_mime_content_finish (_data_->self, _data_->_res_);
	if (_data_->self->priv->message_is_html) {
		_data_->_tmp2_ = _data_->self->priv->web_view;
		_data_->_tmp3_ = _data_->self->priv->message_content;
		mail_web_view_load_html (_data_->_tmp2_, _data_->_tmp3_);
	} else {
		_data_->flags = ((CAMEL_MIME_FILTER_TOHTML_CONVERT_NL | CAMEL_MIME_FILTER_TOHTML_CONVERT_SPACES) | CAMEL_MIME_FILTER_TOHTML_CONVERT_URLS) | CAMEL_MIME_FILTER_TOHTML_CONVERT_ADDRESSES;
		_data_->_tmp4_ = _data_->self->priv->message_content;
		_data_->_tmp5_ = camel_text_to_html (_data_->_tmp4_, _data_->flags, (guint32) 0);
		_data_->html = _data_->_tmp5_;
		_data_->_tmp6_ = _data_->self->priv->web_view;
		_data_->_tmp7_ = _data_->html;
		mail_web_view_load_html (_data_->_tmp6_, _data_->_tmp7_);
		_g_free0 (_data_->html);
	}
	g_task_return_pointer (_data_->_async_result, _data_, NULL);
	if (_data_->_state_ != 0) {
		while (!g_task_get_completed (_data_->_async_result)) {
			g_main_context_iteration (g_task_get_context (_data_->_async_result), TRUE);
		}
	}
	g_object_unref (_data_->_async_result);
	return FALSE;
}

static void
mail_message_list_item_parse_mime_content_data_free (gpointer _data)
{
	MailMessageListItemParseMimeContentData* _data_;
	_data_ = _data;
	_g_object_unref0 (_data_->mime_content);
	_g_object_unref0 (_data_->self);
	g_slice_free (MailMessageListItemParseMimeContentData, _data_);
}

static void
mail_message_list_item_parse_mime_content (MailMessageListItem* self,
                                           CamelDataWrapper* mime_content,
                                           GAsyncReadyCallback _callback_,
                                           gpointer _user_data_)
{
	MailMessageListItemParseMimeContentData* _data_;
	MailMessageListItem* _tmp0_;
	CamelDataWrapper* _tmp1_;
	g_return_if_fail (self != NULL);
	g_return_if_fail (mime_content != NULL);
	_data_ = g_slice_new0 (MailMessageListItemParseMimeContentData);
	_data_->_async_result = g_task_new (G_OBJECT (self), NULL, _callback_, _user_data_);
	g_task_set_task_data (_data_->_async_result, _data_, mail_message_list_item_parse_mime_content_data_free);
	_tmp0_ = _g_object_ref0 (self);
	_data_->self = _tmp0_;
	_tmp1_ = _g_object_ref0 (mime_content);
	_g_object_unref0 (_data_->mime_content);
	_data_->mime_content = _tmp1_;
	mail_message_list_item_parse_mime_content_co (_data_);
}

static void
mail_message_list_item_parse_mime_content_finish (MailMessageListItem* self,
                                                  GAsyncResult* _res_)
{
	MailMessageListItemParseMimeContentData* _data_;
	_data_ = g_task_propagate_pointer (G_TASK (_res_), NULL);
}

static gpointer
_camel_content_type_ref0 (gpointer self)
{
	return self ? camel_content_type_ref (self) : NULL;
}

static void
mail_message_list_item_parse_mime_content_ready (GObject* source_object,
                                                 GAsyncResult* _res_,
                                                 gpointer _user_data_)
{
	MailMessageListItemParseMimeContentData* _data_;
	_data_ = _user_data_;
	_data_->_source_object_ = source_object;
	_data_->_res_ = _res_;
	mail_message_list_item_parse_mime_content_co (_data_);
}

static gboolean
mail_message_list_item_parse_mime_content_co (MailMessageListItemParseMimeContentData* _data_)
{
	switch (_data_->_state_) {
		case 0:
		goto _state_0;
		case 1:
		goto _state_1;
		case 2:
		goto _state_2;
		case 3:
		goto _state_3;
		case 4:
		goto _state_4;
		default:
		g_assert_not_reached ();
	}
	_state_0:
	if (G_TYPE_CHECK_INSTANCE_TYPE (_data_->mime_content, camel_multipart_get_type ())) {
		_data_->_tmp0_ = _g_object_ref0 (G_TYPE_CHECK_INSTANCE_TYPE (_data_->mime_content, camel_multipart_get_type ()) ? ((CamelMultipart*) _data_->mime_content) : NULL);
		_data_->content = _data_->_tmp0_;
		{
			_data_->i = (guint) 0;
			{
				_data_->_tmp1_ = TRUE;
				while (TRUE) {
					if (!_data_->_tmp1_) {
						_data_->_tmp2_ = _data_->i;
						_data_->i = _data_->_tmp2_ + 1;
					}
					_data_->_tmp1_ = FALSE;
					_data_->_tmp3_ = _data_->content;
					if (!(_data_->i < camel_multipart_get_number (_data_->_tmp3_))) {
						break;
					}
					_data_->_tmp4_ = _data_->content;
					_data_->_tmp5_ = camel_multipart_get_part (_data_->_tmp4_, _data_->i);
					_data_->_tmp6_ = _g_object_ref0 (_data_->_tmp5_);
					_data_->part = _data_->_tmp6_;
					_data_->_tmp7_ = _data_->part;
					_data_->_tmp8_ = camel_data_wrapper_get_mime_type_field ((CamelDataWrapper*) _data_->_tmp7_);
					_data_->_tmp9_ = _camel_content_type_ref0 (_data_->_tmp8_);
					_data_->field = _data_->_tmp9_;
					_data_->_tmp10_ = _data_->part;
					_data_->_tmp11_ = camel_mime_part_get_disposition (_data_->_tmp10_);
					_data_->_tmp12_ = _data_->_tmp11_;
					if (g_strcmp0 (_data_->_tmp12_, "inline") == 0) {
						_data_->_tmp13_ = _data_->part;
						_data_->_state_ = 1;
						mail_message_list_item_handle_inline_mime (_data_->self, _data_->_tmp13_, mail_message_list_item_parse_mime_content_ready, _data_);
						return FALSE;
						_state_1:
						mail_message_list_item_handle_inline_mime_finish (_data_->self, _data_->_res_);
					} else {
						_data_->_tmp14_ = _data_->field;
						_data_->_tmp15_ = _data_->_tmp14_->type;
						if (g_strcmp0 (_data_->_tmp15_, "text") == 0) {
							_data_->_tmp16_ = _data_->part;
							_data_->_tmp17_ = camel_medium_get_content ((CamelMedium*) _data_->_tmp16_);
							_data_->_tmp18_ = _data_->_tmp17_;
							_data_->_state_ = 2;
							mail_message_list_item_handle_text_mime (_data_->self, _data_->_tmp18_, mail_message_list_item_parse_mime_content_ready, _data_);
							return FALSE;
							_state_2:
							mail_message_list_item_handle_text_mime_finish (_data_->self, _data_->_res_);
						} else {
							_data_->_tmp19_ = _data_->field;
							_data_->_tmp20_ = _data_->_tmp19_->type;
							if (g_strcmp0 (_data_->_tmp20_, "multipart") == 0) {
								_data_->_tmp21_ = _data_->part;
								_data_->_tmp22_ = camel_medium_get_content ((CamelMedium*) _data_->_tmp21_);
								_data_->_tmp23_ = _data_->_tmp22_;
								_data_->_state_ = 3;
								mail_message_list_item_parse_mime_content (_data_->self, _data_->_tmp23_, mail_message_list_item_parse_mime_content_ready, _data_);
								return FALSE;
								_state_3:
								mail_message_list_item_parse_mime_content_finish (_data_->self, _data_->_res_);
							}
						}
					}
					_camel_content_type_unref0 (_data_->field);
					_g_object_unref0 (_data_->part);
				}
			}
		}
		_g_object_unref0 (_data_->content);
	} else {
		_data_->_state_ = 4;
		mail_message_list_item_handle_text_mime (_data_->self, _data_->mime_content, mail_message_list_item_parse_mime_content_ready, _data_);
		return FALSE;
		_state_4:
		mail_message_list_item_handle_text_mime_finish (_data_->self, _data_->_res_);
	}
	g_task_return_pointer (_data_->_async_result, _data_, NULL);
	if (_data_->_state_ != 0) {
		while (!g_task_get_completed (_data_->_async_result)) {
			g_main_context_iteration (g_task_get_context (_data_->_async_result), TRUE);
		}
	}
	g_object_unref (_data_->_async_result);
	return FALSE;
}

static void
mail_message_list_item_handle_text_mime_data_free (gpointer _data)
{
	MailMessageListItemHandleTextMimeData* _data_;
	_data_ = _data;
	_g_object_unref0 (_data_->part);
	_g_object_unref0 (_data_->self);
	g_slice_free (MailMessageListItemHandleTextMimeData, _data_);
}

static void
mail_message_list_item_handle_text_mime (MailMessageListItem* self,
                                         CamelDataWrapper* part,
                                         GAsyncReadyCallback _callback_,
                                         gpointer _user_data_)
{
	MailMessageListItemHandleTextMimeData* _data_;
	MailMessageListItem* _tmp0_;
	CamelDataWrapper* _tmp1_;
	g_return_if_fail (self != NULL);
	g_return_if_fail (part != NULL);
	_data_ = g_slice_new0 (MailMessageListItemHandleTextMimeData);
	_data_->_async_result = g_task_new (G_OBJECT (self), NULL, _callback_, _user_data_);
	g_task_set_task_data (_data_->_async_result, _data_, mail_message_list_item_handle_text_mime_data_free);
	_tmp0_ = _g_object_ref0 (self);
	_data_->self = _tmp0_;
	_tmp1_ = _g_object_ref0 (part);
	_g_object_unref0 (_data_->part);
	_data_->part = _tmp1_;
	mail_message_list_item_handle_text_mime_co (_data_);
}

static void
mail_message_list_item_handle_text_mime_finish (MailMessageListItem* self,
                                                GAsyncResult* _res_)
{
	MailMessageListItemHandleTextMimeData* _data_;
	_data_ = g_task_propagate_pointer (G_TASK (_res_), NULL);
}

static void
mail_message_list_item_handle_text_mime_ready (GObject* source_object,
                                               GAsyncResult* _res_,
                                               gpointer _user_data_)
{
	MailMessageListItemHandleTextMimeData* _data_;
	_data_ = _user_data_;
	_data_->_source_object_ = source_object;
	_data_->_res_ = _res_;
	mail_message_list_item_handle_text_mime_co (_data_);
}

static gboolean
mail_message_list_item_handle_text_mime_co (MailMessageListItemHandleTextMimeData* _data_)
{
	switch (_data_->_state_) {
		case 0:
		goto _state_0;
		case 1:
		goto _state_1;
		default:
		g_assert_not_reached ();
	}
	_state_0:
	_data_->_tmp0_ = camel_data_wrapper_get_mime_type_field (_data_->part);
	_data_->_tmp1_ = _camel_content_type_ref0 (_data_->_tmp0_);
	_data_->field = _data_->_tmp1_;
	_data_->_tmp3_ = _data_->self->priv->message_content;
	if (_data_->_tmp3_ == NULL) {
		_data_->_tmp2_ = TRUE;
	} else {
		if (!_data_->self->priv->message_is_html) {
			_data_->_tmp5_ = _data_->field;
			_data_->_tmp6_ = _data_->_tmp5_->subtype;
			_data_->_tmp4_ = g_strcmp0 (_data_->_tmp6_, "html") == 0;
		} else {
			_data_->_tmp4_ = FALSE;
		}
		_data_->_tmp2_ = _data_->_tmp4_;
	}
	if (_data_->_tmp2_) {
		_data_->_tmp7_ = (GMemoryOutputStream*) g_memory_output_stream_new_resizable ();
		_data_->os = _data_->_tmp7_;
		{
			_data_->_tmp8_ = _data_->os;
			_data_->_tmp9_ = _data_->self->priv->loading_cancellable;
			_data_->_state_ = 1;
			camel_data_wrapper_decode_to_output_stream (_data_->part, (GOutputStream*) _data_->_tmp8_, G_PRIORITY_DEFAULT, _data_->_tmp9_, mail_message_list_item_handle_text_mime_ready, _data_);
			return FALSE;
			_state_1:
			camel_data_wrapper_decode_to_output_stream_finish (_data_->part, _data_->_res_, &_data_->_inner_error0_);
			if (G_UNLIKELY (_data_->_inner_error0_ != NULL)) {
				goto __catch0_g_error;
			}
			_data_->_tmp10_ = _data_->os;
			g_output_stream_close ((GOutputStream*) _data_->_tmp10_, NULL, &_data_->_inner_error0_);
			if (G_UNLIKELY (_data_->_inner_error0_ != NULL)) {
				goto __catch0_g_error;
			}
		}
		goto __finally0;
		__catch0_g_error:
		{
			_data_->e = _data_->_inner_error0_;
			_data_->_inner_error0_ = NULL;
			_data_->_tmp11_ = _data_->e;
			_data_->_tmp12_ = _data_->_tmp11_->message;
			g_warning ("MessageListItem.vala:534: Possible error decoding email message: %s", _data_->_tmp12_);
			_g_error_free0 (_data_->e);
			_g_object_unref0 (_data_->os);
			_camel_content_type_unref0 (_data_->field);
			g_task_return_pointer (_data_->_async_result, _data_, NULL);
			if (_data_->_state_ != 0) {
				while (!g_task_get_completed (_data_->_async_result)) {
					g_main_context_iteration (g_task_get_context (_data_->_async_result), TRUE);
				}
			}
			g_object_unref (_data_->_async_result);
			return FALSE;
		}
		__finally0:
		if (G_UNLIKELY (_data_->_inner_error0_ != NULL)) {
			_g_object_unref0 (_data_->os);
			_camel_content_type_unref0 (_data_->field);
			g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _data_->_inner_error0_->message, g_quark_to_string (_data_->_inner_error0_->domain), _data_->_inner_error0_->code);
			g_clear_error (&_data_->_inner_error0_);
			g_object_unref (_data_->_async_result);
			return FALSE;
		}
		_data_->_tmp13_ = _data_->os;
		_data_->_tmp14_ = _data_->field;
		_data_->_tmp15_ = camel_content_type_param (_data_->_tmp14_, "charset");
		_data_->_tmp16_ = mail_message_list_item_convert_to_utf8 (_data_->_tmp13_, _data_->_tmp15_);
		_g_free0 (_data_->self->priv->message_content);
		_data_->self->priv->message_content = _data_->_tmp16_;
		_data_->_tmp17_ = _data_->field;
		_data_->_tmp18_ = _data_->_tmp17_->subtype;
		if (g_strcmp0 (_data_->_tmp18_, "html") == 0) {
			_data_->self->priv->message_is_html = TRUE;
		}
		_g_object_unref0 (_data_->os);
	}
	_camel_content_type_unref0 (_data_->field);
	g_task_return_pointer (_data_->_async_result, _data_, NULL);
	if (_data_->_state_ != 0) {
		while (!g_task_get_completed (_data_->_async_result)) {
			g_main_context_iteration (g_task_get_context (_data_->_async_result), TRUE);
		}
	}
	g_object_unref (_data_->_async_result);
	return FALSE;
}

static gchar*
mail_message_list_item_convert_to_utf8 (GMemoryOutputStream* os,
                                        const gchar* encoding)
{
	gint num_bytes = 0;
	gchar* bytes = NULL;
	guint8* _tmp0_;
	gchar* utf8 = NULL;
	gboolean _tmp9_ = FALSE;
	const gchar* _tmp10_;
	GError* _inner_error0_ = NULL;
	gchar* result;
	g_return_val_if_fail (os != NULL, NULL);
	num_bytes = (gint) g_memory_output_stream_get_data_size (os);
	_tmp0_ = g_memory_output_stream_steal_data (os);
	bytes = (gchar*) _tmp0_;
	utf8 = NULL;
	if (encoding != NULL) {
		gchar* iconv_encoding = NULL;
		const gchar* _tmp1_;
		gchar* _tmp2_;
		const gchar* _tmp3_;
		_tmp1_ = camel_iconv_charset_name (encoding);
		_tmp2_ = g_strdup (_tmp1_);
		iconv_encoding = _tmp2_;
		_tmp3_ = iconv_encoding;
		if (_tmp3_ != NULL) {
			{
				gchar* _tmp4_ = NULL;
				const gchar* _tmp5_;
				const gchar* _tmp6_;
				gchar* _tmp7_;
				gchar* _tmp8_;
				_tmp5_ = bytes;
				_tmp6_ = iconv_encoding;
				_tmp7_ = g_convert (_tmp5_, (gssize) num_bytes, "UTF-8", _tmp6_, NULL, NULL, &_inner_error0_);
				_tmp4_ = _tmp7_;
				if (G_UNLIKELY (_inner_error0_ != NULL)) {
					if (_inner_error0_->domain == G_CONVERT_ERROR) {
						goto __catch0_g_convert_error;
					}
					_g_free0 (iconv_encoding);
					_g_free0 (utf8);
					_g_free0 (bytes);
					g_critical ("file %s: line %d: unexpected error: %s (%s, %d)", __FILE__, __LINE__, _inner_error0_->message, g_quark_to_string (_inner_error0_->domain), _inner_error0_->code);
					g_clear_error (&_inner_error0_);
					return NULL;
				}
				_tmp8_ = _tmp4_;
				_tmp4_ = NULL;
				_g_free0 (utf8);
				utf8 = _tmp8_;
				_g_free0 (_tmp4_);
			}
			goto __finally0;
			__catch0_g_convert_error:
			{
				g_clear_error (&_inner_error0_);
			}
			__finally0:
			if (G_UNLIKELY (_inner_error0_ != NULL)) {
				_g_free0 (iconv_encoding);
				_g_free0 (utf8);
				_g_free0 (bytes);
				g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _inner_error0_->message, g_quark_to_string (_inner_error0_->domain), _inner_error0_->code);
				g_clear_error (&_inner_error0_);
				return NULL;
			}
		}
		_g_free0 (iconv_encoding);
	}
	_tmp10_ = utf8;
	if (_tmp10_ == NULL) {
		_tmp9_ = TRUE;
	} else {
		const gchar* _tmp11_;
		_tmp11_ = utf8;
		_tmp9_ = !g_utf8_validate (_tmp11_, (gssize) -1, NULL);
	}
	if (_tmp9_) {
		{
			gchar* _tmp12_ = NULL;
			const gchar* _tmp13_;
			gchar* _tmp14_;
			gchar* _tmp15_;
			_tmp13_ = bytes;
			_tmp14_ = g_convert (_tmp13_, (gssize) num_bytes, "UTF-8", "ISO-8859-1", NULL, NULL, &_inner_error0_);
			_tmp12_ = _tmp14_;
			if (G_UNLIKELY (_inner_error0_ != NULL)) {
				if (_inner_error0_->domain == G_CONVERT_ERROR) {
					goto __catch1_g_convert_error;
				}
				_g_free0 (utf8);
				_g_free0 (bytes);
				g_critical ("file %s: line %d: unexpected error: %s (%s, %d)", __FILE__, __LINE__, _inner_error0_->message, g_quark_to_string (_inner_error0_->domain), _inner_error0_->code);
				g_clear_error (&_inner_error0_);
				return NULL;
			}
			_tmp15_ = _tmp12_;
			_tmp12_ = NULL;
			_g_free0 (utf8);
			utf8 = _tmp15_;
			_g_free0 (_tmp12_);
		}
		goto __finally1;
		__catch1_g_convert_error:
		{
			GError* e = NULL;
			GError* _tmp16_;
			const gchar* _tmp17_;
			gchar* _tmp18_;
			e = _inner_error0_;
			_inner_error0_ = NULL;
			_tmp16_ = e;
			_tmp17_ = _tmp16_->message;
			g_critical ("MessageListItem.vala:572: Every string should be valid ISO-8859-1. Con" \
"vertError: %s", _tmp17_);
			_tmp18_ = g_strdup ("");
			_g_free0 (utf8);
			utf8 = _tmp18_;
			_g_error_free0 (e);
		}
		__finally1:
		if (G_UNLIKELY (_inner_error0_ != NULL)) {
			_g_free0 (utf8);
			_g_free0 (bytes);
			g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _inner_error0_->message, g_quark_to_string (_inner_error0_->domain), _inner_error0_->code);
			g_clear_error (&_inner_error0_);
			return NULL;
		}
	}
	result = utf8;
	_g_free0 (bytes);
	return result;
}

static void
mail_message_list_item_handle_inline_mime_data_free (gpointer _data)
{
	MailMessageListItemHandleInlineMimeData* _data_;
	_data_ = _data;
	_g_object_unref0 (_data_->part);
	_g_object_unref0 (_data_->self);
	g_slice_free (MailMessageListItemHandleInlineMimeData, _data_);
}

static void
mail_message_list_item_handle_inline_mime (MailMessageListItem* self,
                                           CamelMimePart* part,
                                           GAsyncReadyCallback _callback_,
                                           gpointer _user_data_)
{
	MailMessageListItemHandleInlineMimeData* _data_;
	MailMessageListItem* _tmp0_;
	CamelMimePart* _tmp1_;
	g_return_if_fail (self != NULL);
	g_return_if_fail (part != NULL);
	_data_ = g_slice_new0 (MailMessageListItemHandleInlineMimeData);
	_data_->_async_result = g_task_new (G_OBJECT (self), NULL, _callback_, _user_data_);
	g_task_set_task_data (_data_->_async_result, _data_, mail_message_list_item_handle_inline_mime_data_free);
	_tmp0_ = _g_object_ref0 (self);
	_data_->self = _tmp0_;
	_tmp1_ = _g_object_ref0 (part);
	_g_object_unref0 (_data_->part);
	_data_->part = _tmp1_;
	mail_message_list_item_handle_inline_mime_co (_data_);
}

static void
mail_message_list_item_handle_inline_mime_finish (MailMessageListItem* self,
                                                  GAsyncResult* _res_)
{
	MailMessageListItemHandleInlineMimeData* _data_;
	_data_ = g_task_propagate_pointer (G_TASK (_res_), NULL);
}

static gpointer
_g_byte_array_ref0 (gpointer self)
{
	return self ? g_byte_array_ref (self) : NULL;
}

static void
mail_message_list_item_handle_inline_mime_ready (GObject* source_object,
                                                 GAsyncResult* _res_,
                                                 gpointer _user_data_)
{
	MailMessageListItemHandleInlineMimeData* _data_;
	_data_ = _user_data_;
	_data_->_source_object_ = source_object;
	_data_->_res_ = _res_;
	mail_message_list_item_handle_inline_mime_co (_data_);
}

static gboolean
mail_message_list_item_handle_inline_mime_co (MailMessageListItemHandleInlineMimeData* _data_)
{
	switch (_data_->_state_) {
		case 0:
		goto _state_0;
		case 1:
		goto _state_1;
		default:
		g_assert_not_reached ();
	}
	_state_0:
	_data_->_tmp0_ = camel_mime_part_get_content_id (_data_->part);
	if (_data_->_tmp0_ == NULL) {
		g_task_return_pointer (_data_->_async_result, _data_, NULL);
		if (_data_->_state_ != 0) {
			while (!g_task_get_completed (_data_->_async_result)) {
				g_main_context_iteration (g_task_get_context (_data_->_async_result), TRUE);
			}
		}
		g_object_unref (_data_->_async_result);
		return FALSE;
	}
	_data_->_tmp1_ = g_byte_array_new ();
	_data_->byte_array = _data_->_tmp1_;
	_data_->_tmp2_ = (CamelStreamMem*) camel_stream_mem_new ();
	_data_->os = _data_->_tmp2_;
	_data_->_tmp3_ = _data_->os;
	_data_->_tmp4_ = _data_->byte_array;
	_data_->_tmp5_ = _g_byte_array_ref0 (_data_->_tmp4_);
	camel_stream_mem_set_byte_array (_data_->_tmp3_, _data_->_tmp5_);
	{
		_data_->_tmp6_ = camel_medium_get_content ((CamelMedium*) _data_->part);
		_data_->_tmp7_ = _data_->_tmp6_;
		_data_->_tmp8_ = _data_->os;
		_data_->_tmp9_ = _data_->self->priv->loading_cancellable;
		_data_->_state_ = 1;
		camel_data_wrapper_decode_to_stream (_data_->_tmp7_, (CamelStream*) _data_->_tmp8_, G_PRIORITY_DEFAULT, _data_->_tmp9_, mail_message_list_item_handle_inline_mime_ready, _data_);
		return FALSE;
		_state_1:
		camel_data_wrapper_decode_to_stream_finish (_data_->_tmp7_, _data_->_res_, &_data_->_inner_error0_);
		if (G_UNLIKELY (_data_->_inner_error0_ != NULL)) {
			goto __catch0_g_error;
		}
	}
	goto __finally0;
	__catch0_g_error:
	{
		_data_->e = _data_->_inner_error0_;
		_data_->_inner_error0_ = NULL;
		_data_->_tmp10_ = _data_->e;
		_data_->_tmp11_ = _data_->_tmp10_->message;
		g_warning ("MessageListItem.vala:591: Error decoding inline attachment: %s", _data_->_tmp11_);
		_g_error_free0 (_data_->e);
		_g_object_unref0 (_data_->os);
		_g_byte_array_unref0 (_data_->byte_array);
		g_task_return_pointer (_data_->_async_result, _data_, NULL);
		if (_data_->_state_ != 0) {
			while (!g_task_get_completed (_data_->_async_result)) {
				g_main_context_iteration (g_task_get_context (_data_->_async_result), TRUE);
			}
		}
		g_object_unref (_data_->_async_result);
		return FALSE;
	}
	__finally0:
	if (G_UNLIKELY (_data_->_inner_error0_ != NULL)) {
		_g_object_unref0 (_data_->os);
		_g_byte_array_unref0 (_data_->byte_array);
		g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _data_->_inner_error0_->message, g_quark_to_string (_data_->_inner_error0_->domain), _data_->_inner_error0_->code);
		g_clear_error (&_data_->_inner_error0_);
		g_object_unref (_data_->_async_result);
		return FALSE;
	}
	_data_->_tmp12_ = _data_->byte_array;
	_data_->_tmp13_ = _g_byte_array_ref0 (_data_->_tmp12_);
	_data_->_tmp14_ = g_byte_array_free_to_bytes (_data_->_tmp13_);
	_data_->bytes = _data_->_tmp14_;
	_data_->_tmp15_ = _data_->bytes;
	_data_->_tmp16_ = (GMemoryInputStream*) g_memory_input_stream_new_from_bytes (_data_->_tmp15_);
	_data_->inline_stream = _data_->_tmp16_;
	_data_->_tmp17_ = _data_->self->priv->web_view;
	_data_->_tmp18_ = camel_mime_part_get_content_id (_data_->part);
	_data_->_tmp19_ = _data_->inline_stream;
	mail_web_view_add_internal_resource (_data_->_tmp17_, _data_->_tmp18_, (GInputStream*) _data_->_tmp19_);
	_g_object_unref0 (_data_->inline_stream);
	_g_bytes_unref0 (_data_->bytes);
	_g_object_unref0 (_data_->os);
	_g_byte_array_unref0 (_data_->byte_array);
	g_task_return_pointer (_data_->_async_result, _data_, NULL);
	if (_data_->_state_ != 0) {
		while (!g_task_get_completed (_data_->_async_result)) {
			g_main_context_iteration (g_task_get_context (_data_->_async_result), TRUE);
		}
	}
	g_object_unref (_data_->_async_result);
	return FALSE;
}

static void
mail_message_list_item_get_message_body_html_data_free (gpointer _data)
{
	MailMessageListItemGetMessageBodyHtmlData* _data_;
	_data_ = _data;
	_g_free0 (_data_->result);
	_g_object_unref0 (_data_->self);
	g_slice_free (MailMessageListItemGetMessageBodyHtmlData, _data_);
}

void
mail_message_list_item_get_message_body_html (MailMessageListItem* self,
                                              GAsyncReadyCallback _callback_,
                                              gpointer _user_data_)
{
	MailMessageListItemGetMessageBodyHtmlData* _data_;
	MailMessageListItem* _tmp0_;
	g_return_if_fail (self != NULL);
	_data_ = g_slice_new0 (MailMessageListItemGetMessageBodyHtmlData);
	_data_->_async_result = g_task_new (G_OBJECT (self), NULL, _callback_, _user_data_);
	g_task_set_task_data (_data_->_async_result, _data_, mail_message_list_item_get_message_body_html_data_free);
	_tmp0_ = _g_object_ref0 (self);
	_data_->self = _tmp0_;
	mail_message_list_item_get_message_body_html_co (_data_);
}

gchar*
mail_message_list_item_get_message_body_html_finish (MailMessageListItem* self,
                                                     GAsyncResult* _res_)
{
	gchar* result;
	MailMessageListItemGetMessageBodyHtmlData* _data_;
	_data_ = g_task_propagate_pointer (G_TASK (_res_), NULL);
	result = _data_->result;
	_data_->result = NULL;
	return result;
}

static void
mail_message_list_item_get_message_body_html_ready (GObject* source_object,
                                                    GAsyncResult* _res_,
                                                    gpointer _user_data_)
{
	MailMessageListItemGetMessageBodyHtmlData* _data_;
	_data_ = _user_data_;
	_data_->_source_object_ = source_object;
	_data_->_res_ = _res_;
	mail_message_list_item_get_message_body_html_co (_data_);
}

static gboolean
mail_message_list_item_get_message_body_html_co (MailMessageListItemGetMessageBodyHtmlData* _data_)
{
	switch (_data_->_state_) {
		case 0:
		goto _state_0;
		case 1:
		goto _state_1;
		default:
		g_assert_not_reached ();
	}
	_state_0:
	_data_->_tmp0_ = _data_->self->priv->web_view;
	_data_->_state_ = 1;
	mail_web_view_get_body_html (_data_->_tmp0_, mail_message_list_item_get_message_body_html_ready, _data_);
	return FALSE;
	_state_1:
	_data_->_tmp1_ = mail_web_view_get_body_html_finish (_data_->_tmp0_, _data_->_res_);
	_data_->result = _data_->_tmp1_;
	g_task_return_pointer (_data_->_async_result, _data_, NULL);
	if (_data_->_state_ != 0) {
		while (!g_task_get_completed (_data_->_async_result)) {
			g_main_context_iteration (g_task_get_context (_data_->_async_result), TRUE);
		}
	}
	g_object_unref (_data_->_async_result);
	return FALSE;
}

gboolean
mail_message_list_item_get_loaded (MailMessageListItem* self)
{
	gboolean result;
	g_return_val_if_fail (self != NULL, FALSE);
	result = self->priv->_loaded;
	return result;
}

static void
mail_message_list_item_set_loaded (MailMessageListItem* self,
                                   gboolean value)
{
	gboolean old_value;
	g_return_if_fail (self != NULL);
	old_value = mail_message_list_item_get_loaded (self);
	if (old_value != value) {
		self->priv->_loaded = value;
		g_object_notify_by_pspec ((GObject *) self, mail_message_list_item_properties[MAIL_MESSAGE_LIST_ITEM_LOADED_PROPERTY]);
	}
}

CamelMessageInfo*
mail_message_list_item_get_message_info (MailMessageListItem* self)
{
	CamelMessageInfo* result;
	CamelMessageInfo* _tmp0_;
	g_return_val_if_fail (self != NULL, NULL);
	_tmp0_ = self->priv->_message_info;
	result = _tmp0_;
	return result;
}

static void
mail_message_list_item_set_message_info (MailMessageListItem* self,
                                         CamelMessageInfo* value)
{
	CamelMessageInfo* old_value;
	g_return_if_fail (self != NULL);
	old_value = mail_message_list_item_get_message_info (self);
	if (old_value != value) {
		CamelMessageInfo* _tmp0_;
		_tmp0_ = _g_object_ref0 (value);
		_g_object_unref0 (self->priv->_message_info);
		self->priv->_message_info = _tmp0_;
		g_object_notify_by_pspec ((GObject *) self, mail_message_list_item_properties[MAIL_MESSAGE_LIST_ITEM_MESSAGE_INFO_PROPERTY]);
	}
}

CamelMimeMessage*
mail_message_list_item_get_mime_message (MailMessageListItem* self)
{
	CamelMimeMessage* result;
	CamelMimeMessage* _tmp0_;
	g_return_val_if_fail (self != NULL, NULL);
	_tmp0_ = self->priv->_mime_message;
	result = _tmp0_;
	return result;
}

static void
mail_message_list_item_set_mime_message (MailMessageListItem* self,
                                         CamelMimeMessage* value)
{
	CamelMimeMessage* old_value;
	g_return_if_fail (self != NULL);
	old_value = mail_message_list_item_get_mime_message (self);
	if (old_value != value) {
		CamelMimeMessage* _tmp0_;
		_tmp0_ = _g_object_ref0 (value);
		_g_object_unref0 (self->priv->_mime_message);
		self->priv->_mime_message = _tmp0_;
		g_object_notify_by_pspec ((GObject *) self, mail_message_list_item_properties[MAIL_MESSAGE_LIST_ITEM_MIME_MESSAGE_PROPERTY]);
	}
}

gboolean
mail_message_list_item_get_expanded (MailMessageListItem* self)
{
	gboolean result;
	GtkRevealer* _tmp0_;
	gboolean _tmp1_;
	gboolean _tmp2_;
	g_return_val_if_fail (self != NULL, FALSE);
	_tmp0_ = self->priv->secondary_revealer;
	_tmp1_ = gtk_revealer_get_reveal_child (_tmp0_);
	_tmp2_ = _tmp1_;
	result = _tmp2_;
	return result;
}

void
mail_message_list_item_set_expanded (MailMessageListItem* self,
                                     gboolean value)
{
	GtkRevealer* _tmp0_;
	const gchar* _tmp1_ = NULL;
	GtkStack* _tmp2_;
	g_return_if_fail (self != NULL);
	_tmp0_ = self->priv->secondary_revealer;
	gtk_revealer_set_reveal_child (_tmp0_, value);
	if (value) {
		_tmp1_ = "large";
	} else {
		_tmp1_ = "small";
	}
	_tmp2_ = self->priv->header_stack;
	gtk_stack_set_visible_child_name (_tmp2_, _tmp1_);
	if (value) {
		GtkStyleContext* _tmp3_;
		if (!self->priv->message_loaded) {
			mail_message_list_item_get_message (self, NULL, NULL);
			self->priv->message_loaded = TRUE;
		}
		_tmp3_ = self->priv->style_context;
		gtk_style_context_remove_class (_tmp3_, "collapsed");
	} else {
		GtkStyleContext* _tmp4_;
		_tmp4_ = self->priv->style_context;
		gtk_style_context_add_class (_tmp4_, "collapsed");
	}
	g_object_notify_by_pspec ((GObject *) self, mail_message_list_item_properties[MAIL_MESSAGE_LIST_ITEM_EXPANDED_PROPERTY]);
}

static Block32Data*
block32_data_ref (Block32Data* _data32_)
{
	g_atomic_int_inc (&_data32_->_ref_count_);
	return _data32_;
}

static void
block32_data_unref (void * _userdata_)
{
	Block32Data* _data32_;
	_data32_ = (Block32Data*) _userdata_;
	if (g_atomic_int_dec_and_test (&_data32_->_ref_count_)) {
		MailMessageListItem* self;
		self = _data32_->self;
		_g_object_unref0 (_data32_->header_event_box);
		_g_object_unref0 (_data32_->actions_menu_button);
		_g_object_unref0 (_data32_->starred_icon);
		_g_object_unref0 (self);
		g_slice_free (Block32Data, _data32_);
	}
}

static void
_mail_message_list_item___lambda82_ (MailMessageListItem* self)
{
	mail_message_list_item_add_inline_composer (self, MAIL_COMPOSER_WIDGET_TYPE_REPLY);
}

static void
__mail_message_list_item___lambda82__gtk_menu_item_activate (GtkMenuItem* _sender,
                                                             gpointer self)
{
	_mail_message_list_item___lambda82_ ((MailMessageListItem*) self);
}

static void
_mail_message_list_item___lambda83_ (MailMessageListItem* self)
{
	mail_message_list_item_add_inline_composer (self, MAIL_COMPOSER_WIDGET_TYPE_REPLY_ALL);
}

static void
__mail_message_list_item___lambda83__gtk_menu_item_activate (GtkMenuItem* _sender,
                                                             gpointer self)
{
	_mail_message_list_item___lambda83_ ((MailMessageListItem*) self);
}

static void
_mail_message_list_item___lambda84_ (MailMessageListItem* self)
{
	mail_message_list_item_add_inline_composer (self, MAIL_COMPOSER_WIDGET_TYPE_FORWARD);
}

static void
__mail_message_list_item___lambda84__gtk_menu_item_activate (GtkMenuItem* _sender,
                                                             gpointer self)
{
	_mail_message_list_item___lambda84_ ((MailMessageListItem*) self);
}

static void
_mail_message_list_item_on_print_gtk_menu_item_activate (GtkMenuItem* _sender,
                                                         gpointer self)
{
	mail_message_list_item_on_print ((MailMessageListItem*) self);
}

static void
_mail_message_list_item_on_mouse_target_changed_webkit_web_view_mouse_target_changed (WebKitWebView* _sender,
                                                                                      WebKitHitTestResult* hit_test_result,
                                                                                      guint modifiers,
                                                                                      gpointer self)
{
	mail_message_list_item_on_mouse_target_changed ((MailMessageListItem*) self, _sender, hit_test_result, modifiers);
}

static gboolean
_mail_message_list_item_on_webview_context_menu_webkit_web_view_context_menu (WebKitWebView* _sender,
                                                                              WebKitContextMenu* context_menu,
                                                                              GdkEvent* event,
                                                                              WebKitHitTestResult* hit_test_result,
                                                                              gpointer self)
{
	gboolean result;
	result = mail_message_list_item_on_webview_context_menu ((MailMessageListItem*) self, context_menu, event, hit_test_result);
	return result;
}

static void
_mail_message_list_item___lambda85_ (MailMessageListItem* self)
{
	mail_message_list_item_set_loaded (self, TRUE);
}

static void
__mail_message_list_item___lambda85__mail_web_view_load_finished (MailWebView* _sender,
                                                                  gpointer self)
{
	_mail_message_list_item___lambda85_ ((MailMessageListItem*) self);
}

static gboolean
_mail_message_list_item___lambda86_ (Block32Data* _data32_,
                                     GdkEventButton* event)
{
	MailMessageListItem* self;
	GtkMenuButton* _tmp0_;
	gboolean result;
	self = _data32_->self;
	g_return_val_if_fail (event != NULL, FALSE);
	_tmp0_ = _data32_->actions_menu_button;
	gtk_toggle_button_set_active ((GtkToggleButton*) _tmp0_, TRUE);
	result = GDK_EVENT_STOP;
	return result;
}

static gboolean
__mail_message_list_item___lambda86__gtk_widget_button_release_event (GtkWidget* _sender,
                                                                      GdkEventButton* event,
                                                                      gpointer self)
{
	gboolean result;
	result = _mail_message_list_item___lambda86_ (self, event);
	return result;
}

static gboolean
_mail_message_list_item___lambda87_ (Block32Data* _data32_,
                                     GdkEventCrossing* event)
{
	MailMessageListItem* self;
	self = _data32_->self;
	g_return_val_if_fail (event != NULL, FALSE);
	if (event->detail != GDK_NOTIFY_INFERIOR) {
		GdkWindow* window = NULL;
		GtkEventBox* _tmp0_;
		GdkWindow* _tmp1_;
		GdkWindow* _tmp2_;
		GdkCursor* cursor = NULL;
		GdkWindow* _tmp3_;
		GdkDisplay* _tmp4_;
		GdkCursor* _tmp5_;
		GdkWindow* _tmp6_;
		GdkCursor* _tmp7_;
		_tmp0_ = _data32_->header_event_box;
		_tmp1_ = gtk_widget_get_window ((GtkWidget*) _tmp0_);
		_tmp2_ = _g_object_ref0 (_tmp1_);
		window = _tmp2_;
		_tmp3_ = window;
		_tmp4_ = gdk_window_get_display (_tmp3_);
		_tmp5_ = gdk_cursor_new_from_name (_tmp4_, "pointer");
		cursor = _tmp5_;
		_tmp6_ = window;
		_tmp7_ = cursor;
		gdk_window_set_cursor (_tmp6_, _tmp7_);
		_g_object_unref0 (cursor);
		_g_object_unref0 (window);
	}
}

static gboolean
__mail_message_list_item___lambda87__gtk_widget_enter_notify_event (GtkWidget* _sender,
                                                                    GdkEventCrossing* event,
                                                                    gpointer self)
{
	gboolean result;
	result = _mail_message_list_item___lambda87_ (self, event);
	return result;
}

static gboolean
_mail_message_list_item___lambda88_ (Block32Data* _data32_,
                                     GdkEventCrossing* event)
{
	MailMessageListItem* self;
	self = _data32_->self;
	g_return_val_if_fail (event != NULL, FALSE);
	if (event->detail != GDK_NOTIFY_INFERIOR) {
		GtkEventBox* _tmp0_;
		GdkWindow* _tmp1_;
		_tmp0_ = _data32_->header_event_box;
		_tmp1_ = gtk_widget_get_window ((GtkWidget*) _tmp0_);
		gdk_window_set_cursor (_tmp1_, NULL);
	}
}

static gboolean
__mail_message_list_item___lambda88__gtk_widget_leave_notify_event (GtkWidget* _sender,
                                                                    GdkEventCrossing* event,
                                                                    gpointer self)
{
	gboolean result;
	result = _mail_message_list_item___lambda88_ (self, event);
	return result;
}

static gboolean
_mail_message_list_item___lambda89_ (MailMessageListItem* self,
                                     GdkEventButton* event)
{
	gboolean _tmp0_;
	gboolean _tmp1_;
	gboolean result;
	g_return_val_if_fail (event != NULL, FALSE);
	_tmp0_ = mail_message_list_item_get_expanded (self);
	_tmp1_ = _tmp0_;
	mail_message_list_item_set_expanded (self, !_tmp1_);
	result = GDK_EVENT_STOP;
	return result;
}

static gboolean
__mail_message_list_item___lambda89__gtk_widget_button_release_event (GtkWidget* _sender,
                                                                      GdkEventButton* event,
                                                                      gpointer self)
{
	gboolean result;
	result = _mail_message_list_item___lambda89_ ((MailMessageListItem*) self, event);
	return result;
}

static void
_mail_message_list_item___lambda90_ (MailMessageListItem* self)
{
	GCancellable* _tmp0_;
	_tmp0_ = self->priv->loading_cancellable;
	g_cancellable_cancel (_tmp0_);
}

static void
__mail_message_list_item___lambda90__gtk_widget_destroy (GtkWidget* _sender,
                                                         gpointer self)
{
	_mail_message_list_item___lambda90_ ((MailMessageListItem*) self);
}

static gboolean
_mail_message_list_item___lambda91_ (Block32Data* _data32_)
{
	MailMessageListItem* self;
	CamelMessageInfo* _tmp0_;
	CamelMessageFlags _tmp1_;
	CamelMessageFlags _tmp2_;
	gboolean result;
	self = _data32_->self;
	_tmp0_ = self->priv->_message_info;
	g_object_get (_tmp0_, "flags", &_tmp1_, NULL);
	_tmp2_ = _tmp1_;
	if ((((gint) _tmp2_) & CAMEL_MESSAGE_FLAGGED) == CAMEL_MESSAGE_FLAGGED) {
		CamelMessageInfo* _tmp3_;
		GtkImage* _tmp4_;
		GtkImage* _tmp5_;
		_tmp3_ = self->priv->_message_info;
		camel_message_info_set_flags (_tmp3_, (guint32) CAMEL_MESSAGE_FLAGGED, (guint32) 0);
		_tmp4_ = _data32_->starred_icon;
		g_object_set (_tmp4_, "icon-name", "non-starred-symbolic", NULL);
		_tmp5_ = _data32_->starred_icon;
		gtk_widget_set_tooltip_text ((GtkWidget*) _tmp5_, _ ("Star message"));
	} else {
		CamelMessageInfo* _tmp6_;
		GtkImage* _tmp7_;
		GtkImage* _tmp8_;
		_tmp6_ = self->priv->_message_info;
		camel_message_info_set_flags (_tmp6_, (guint32) CAMEL_MESSAGE_FLAGGED, (guint32) (~0));
		_tmp7_ = _data32_->starred_icon;
		g_object_set (_tmp7_, "icon-name", "starred-symbolic", NULL);
		_tmp8_ = _data32_->starred_icon;
		gtk_widget_set_tooltip_text ((GtkWidget*) _tmp8_, _ ("Unstar message"));
	}
	result = GDK_EVENT_STOP;
	return result;
}

static gboolean
__mail_message_list_item___lambda91__gtk_widget_button_release_event (GtkWidget* _sender,
                                                                      GdkEventButton* event,
                                                                      gpointer self)
{
	gboolean result;
	result = _mail_message_list_item___lambda91_ (self);
	return result;
}

static void
_mail_message_list_item___lambda92_ (MailMessageListItem* self)
{
	GtkInfoBar* _tmp0_;
	_tmp0_ = self->priv->blocked_images_infobar;
	gtk_widget_show ((GtkWidget*) _tmp0_);
}

static void
__mail_message_list_item___lambda92__mail_web_view_image_load_blocked (MailWebView* _sender,
                                                                       gpointer self)
{
	_mail_message_list_item___lambda92_ ((MailMessageListItem*) self);
}

static void
_mail_message_list_item___lambda93_ (MailMessageListItem* self,
                                     const gchar* uri)
{
	GError* _inner_error0_ = NULL;
	g_return_if_fail (uri != NULL);
	{
		g_app_info_launch_default_for_uri (uri, NULL, &_inner_error0_);
		if (G_UNLIKELY (_inner_error0_ != NULL)) {
			goto __catch0_g_error;
		}
	}
	goto __finally0;
	__catch0_g_error:
	{
		GError* e = NULL;
		GError* _tmp0_;
		const gchar* _tmp1_;
		e = _inner_error0_;
		_inner_error0_ = NULL;
		_tmp0_ = e;
		_tmp1_ = _tmp0_->message;
		g_warning ("MessageListItem.vala:353: Failed to open link: %s", _tmp1_);
		_g_error_free0 (e);
	}
	__finally0:
	if (G_UNLIKELY (_inner_error0_ != NULL)) {
		g_critical ("file %s: line %d: uncaught error: %s (%s, %d)", __FILE__, __LINE__, _inner_error0_->message, g_quark_to_string (_inner_error0_->domain), _inner_error0_->code);
		g_clear_error (&_inner_error0_);
		return;
	}
}

static void
__mail_message_list_item___lambda93__mail_web_view_link_activated (MailWebView* _sender,
                                                                   const gchar* url,
                                                                   gpointer self)
{
	_mail_message_list_item___lambda93_ ((MailMessageListItem*) self, url);
}

static GObject *
mail_message_list_item_constructor (GType type,
                                    guint n_construct_properties,
                                    GObjectConstructParam * construct_properties)
{
	GObject * obj;
	GObjectClass * parent_class;
	MailMessageListItem * self;
	Block32Data* _data32_;
	GCancellable* _tmp0_;
	GtkStyleContext* _tmp1_;
	GtkStyleContext* _tmp2_;
	GtkStyleContext* _tmp3_;
	const gchar* parsed_address = NULL;
	const gchar* parsed_name = NULL;
	CamelInternetAddress* camel_address = NULL;
	CamelInternetAddress* _tmp4_;
	CamelInternetAddress* _tmp5_;
	CamelMessageInfo* _tmp6_;
	const gchar* _tmp7_;
	const gchar* _tmp8_;
	CamelInternetAddress* _tmp9_;
	const gchar* _tmp10_ = NULL;
	const gchar* _tmp11_ = NULL;
	const gchar* _tmp12_;
	const gchar* _tmp14_;
	HdyAvatar* _tmp15_ = NULL;
	GtkLabel* from_label = NULL;
	GtkLabel* _tmp16_;
	GtkLabel* _tmp17_;
	GtkLabel* _tmp18_;
	GtkLabel* _tmp19_;
	GtkStyleContext* _tmp20_;
	GtkLabel* to_label = NULL;
	GtkLabel* _tmp21_;
	GtkLabel* _tmp22_;
	GtkLabel* _tmp23_;
	GtkLabel* _tmp24_;
	GtkStyleContext* _tmp25_;
	GtkLabel* subject_label = NULL;
	GtkLabel* _tmp26_;
	GtkLabel* _tmp27_;
	GtkLabel* _tmp28_;
	GtkLabel* _tmp29_;
	GtkStyleContext* _tmp30_;
	GtkLabel* from_val_label = NULL;
	CamelMessageInfo* _tmp31_;
	const gchar* _tmp32_;
	const gchar* _tmp33_;
	GtkLabel* _tmp34_;
	GtkLabel* _tmp35_;
	GtkLabel* _tmp36_;
	GtkLabel* to_val_label = NULL;
	CamelMessageInfo* _tmp37_;
	const gchar* _tmp38_;
	const gchar* _tmp39_;
	GtkLabel* _tmp40_;
	GtkLabel* _tmp41_;
	GtkLabel* _tmp42_;
	GtkLabel* subject_val_label = NULL;
	CamelMessageInfo* _tmp43_;
	const gchar* _tmp44_;
	const gchar* _tmp45_;
	GtkLabel* _tmp46_;
	GtkLabel* _tmp47_;
	GtkLabel* _tmp48_;
	GtkGrid* fields_grid = NULL;
	GtkGrid* _tmp49_;
	GtkGrid* _tmp50_;
	GtkGrid* _tmp51_;
	GtkGrid* _tmp52_;
	GtkLabel* _tmp53_;
	GtkGrid* _tmp54_;
	GtkLabel* _tmp55_;
	GtkGrid* _tmp56_;
	GtkLabel* _tmp57_;
	GtkGrid* _tmp58_;
	GtkLabel* _tmp59_;
	GtkGrid* _tmp60_;
	GtkLabel* _tmp61_;
	GtkGrid* _tmp62_;
	GtkLabel* _tmp63_;
	gchar* cc_info = NULL;
	CamelMessageInfo* _tmp64_;
	const gchar* _tmp65_;
	const gchar* _tmp66_;
	gchar* _tmp67_;
	const gchar* _tmp68_;
	GtkLabel* small_from_label = NULL;
	CamelMessageInfo* _tmp82_;
	const gchar* _tmp83_;
	const gchar* _tmp84_;
	GtkLabel* _tmp85_;
	GtkLabel* _tmp86_;
	GtkLabel* _tmp87_;
	GtkGrid* small_fields_grid = NULL;
	GtkGrid* _tmp88_;
	GtkGrid* _tmp89_;
	GtkLabel* _tmp90_;
	GtkStack* _tmp91_;
	GtkStack* _tmp92_;
	GtkStack* _tmp93_;
	GtkStack* _tmp94_;
	GtkGrid* _tmp95_;
	GtkStack* _tmp96_;
	GtkGrid* _tmp97_;
	GtkStack* _tmp98_;
	gint64 relevant_timestamp = 0LL;
	CamelMessageInfo* _tmp99_;
	gint64 _tmp100_;
	gint64 _tmp101_;
	gchar* date_format = NULL;
	gchar* _tmp105_;
	gchar* time_format = NULL;
	GSettings* _tmp106_;
	gchar* _tmp107_;
	GtkLabel* datetime_label = NULL;
	GDateTime* _tmp108_;
	GDateTime* _tmp109_;
	GDateTime* _tmp110_;
	GDateTime* _tmp111_;
	const gchar* _tmp112_;
	const gchar* _tmp113_;
	gchar* _tmp114_;
	gchar* _tmp115_;
	gchar* _tmp116_;
	gchar* _tmp117_;
	GtkLabel* _tmp118_;
	GtkLabel* _tmp119_;
	GtkLabel* _tmp120_;
	GtkStyleContext* _tmp121_;
	GtkImage* _tmp122_;
	GtkImage* _tmp123_;
	CamelMessageInfo* _tmp124_;
	CamelMessageFlags _tmp125_;
	CamelMessageFlags _tmp126_;
	GtkButton* starred_button = NULL;
	GtkButton* _tmp131_;
	GtkButton* _tmp132_;
	GtkImage* _tmp133_;
	GtkButton* _tmp134_;
	GtkStyleContext* _tmp135_;
	GtkMenuItem* reply_item = NULL;
	GtkMenuItem* _tmp136_;
	GtkMenuItem* _tmp137_;
	GtkMenuItem* reply_all_item = NULL;
	GtkMenuItem* _tmp138_;
	GtkMenuItem* _tmp139_;
	GtkMenuItem* forward_item = NULL;
	GtkMenuItem* _tmp140_;
	GtkMenuItem* _tmp141_;
	GtkMenuItem* print_item = NULL;
	GtkMenuItem* _tmp142_;
	GtkMenuItem* _tmp143_;
	GtkMenu* actions_menu = NULL;
	GtkMenu* _tmp144_;
	GtkMenu* _tmp145_;
	GtkMenuItem* _tmp146_;
	GtkMenu* _tmp147_;
	GtkMenuItem* _tmp148_;
	GtkMenu* _tmp149_;
	GtkMenuItem* _tmp150_;
	GtkMenu* _tmp151_;
	GtkSeparatorMenuItem* _tmp152_;
	GtkSeparatorMenuItem* _tmp153_;
	GtkMenu* _tmp154_;
	GtkMenuItem* _tmp155_;
	GtkMenu* _tmp156_;
	GtkMenuButton* _tmp157_;
	GtkMenuButton* _tmp158_;
	GtkImage* _tmp159_;
	GtkImage* _tmp160_;
	GtkMenuButton* _tmp161_;
	GtkStyleContext* _tmp162_;
	GtkMenuButton* _tmp163_;
	GtkMenuButton* _tmp164_;
	GtkMenuButton* _tmp165_;
	GtkMenuButton* _tmp166_;
	GtkMenuButton* _tmp167_;
	GtkMenu* _tmp168_;
	GtkGrid* action_grid = NULL;
	GtkGrid* _tmp169_;
	GtkGrid* _tmp170_;
	GtkGrid* _tmp171_;
	GtkGrid* _tmp172_;
	GtkGrid* _tmp173_;
	GtkGrid* _tmp174_;
	GtkLabel* _tmp175_;
	GtkGrid* _tmp176_;
	GtkButton* _tmp177_;
	GtkGrid* _tmp178_;
	GtkMenuButton* _tmp179_;
	GtkGrid* header = NULL;
	GtkGrid* _tmp180_;
	GtkGrid* _tmp181_;
	GtkGrid* _tmp182_;
	GtkGrid* _tmp183_;
	HdyAvatar* _tmp184_;
	GtkGrid* _tmp185_;
	GtkStack* _tmp186_;
	GtkGrid* _tmp187_;
	GtkGrid* _tmp188_;
	GtkEventBox* _tmp189_;
	GtkEventBox* _tmp190_;
	GtkEventBox* _tmp191_;
	GdkEventMask _tmp192_;
	GdkEventMask _tmp193_;
	GtkEventBox* _tmp194_;
	GtkEventBox* _tmp195_;
	GdkEventMask _tmp196_;
	GdkEventMask _tmp197_;
	GtkEventBox* _tmp198_;
	GtkEventBox* _tmp199_;
	GdkEventMask _tmp200_;
	GdkEventMask _tmp201_;
	GtkEventBox* _tmp202_;
	GtkGrid* _tmp203_;
	GtkSeparator* separator = NULL;
	GtkSeparator* _tmp204_;
	GtkSeparator* _tmp205_;
	GSettings* _tmp206_;
	GtkInfoBar* _tmp207_;
	GtkInfoBar* _tmp208_;
	GtkInfoBar* _tmp209_;
	GtkInfoBar* _tmp210_;
	GtkInfoBar* _tmp211_;
	GtkInfoBar* _tmp212_;
	GtkStyleContext* _tmp213_;
	GtkInfoBar* _tmp214_;
	GtkContainer* infobar_content = NULL;
	GtkInfoBar* _tmp215_;
	GtkContainer* _tmp216_;
	GtkContainer* _tmp217_;
	GtkContainer* _tmp218_;
	GtkLabel* _tmp219_;
	GtkLabel* _tmp220_;
	GtkContainer* _tmp221_;
	GtkInfoBar* _tmp222_;
	GtkBox* _tmp223_;
	MailWebView* _tmp224_;
	MailWebView* _tmp225_;
	MailWebView* _tmp226_;
	MailWebView* _tmp227_;
	MailWebView* _tmp228_;
	GtkGrid* secondary_grid = NULL;
	GtkGrid* _tmp229_;
	GtkGrid* _tmp230_;
	GtkGrid* _tmp231_;
	GtkSeparator* _tmp232_;
	GtkGrid* _tmp233_;
	GtkInfoBar* _tmp234_;
	GtkGrid* _tmp235_;
	MailWebView* _tmp236_;
	GtkRevealer* _tmp237_;
	GtkRevealer* _tmp238_;
	GtkRevealer* _tmp239_;
	GtkGrid* _tmp240_;
	GtkGrid* base_grid = NULL;
	GtkGrid* _tmp241_;
	GtkGrid* _tmp242_;
	GtkGrid* _tmp243_;
	GtkGrid* _tmp244_;
	GtkEventBox* _tmp245_;
	GtkGrid* _tmp246_;
	GtkRevealer* _tmp247_;
	CamelMessageInfo* _tmp248_;
	CamelMessageFlags _tmp249_;
	CamelMessageFlags _tmp250_;
	GtkGrid* _tmp260_;
	HdyAvatar* _tmp261_;
	const gchar* _tmp262_;
	GtkStyleContext* _tmp263_;
	GravatarIcon* _tmp264_;
	GravatarIcon* _tmp265_;
	GtkMenuButton* _tmp266_;
	GtkEventBox* _tmp267_;
	GtkEventBox* _tmp268_;
	GtkEventBox* _tmp269_;
	GtkButton* _tmp270_;
	MailWebView* _tmp271_;
	MailWebView* _tmp272_;
	parent_class = G_OBJECT_CLASS (mail_message_list_item_parent_class);
	obj = parent_class->constructor (type, n_construct_properties, construct_properties);
	self = G_TYPE_CHECK_INSTANCE_CAST (obj, MAIL_TYPE_MESSAGE_LIST_ITEM, MailMessageListItem);
	_data32_ = g_slice_new0 (Block32Data);
	_data32_->_ref_count_ = 1;
	_data32_->self = g_object_ref (self);
	_tmp0_ = g_cancellable_new ();
	_g_object_unref0 (self->priv->loading_cancellable);
	self->priv->loading_cancellable = _tmp0_;
	_tmp1_ = gtk_widget_get_style_context ((GtkWidget*) self);
	_tmp2_ = _g_object_ref0 (_tmp1_);
	_g_object_unref0 (self->priv->style_context);
	self->priv->style_context = _tmp2_;
	_tmp3_ = self->priv->style_context;
	gtk_style_context_add_class (_tmp3_, GRANITE_STYLE_CLASS_CARD);
	_tmp4_ = camel_internet_address_new ();
	camel_address = _tmp4_;
	_tmp5_ = camel_address;
	_tmp6_ = self->priv->_message_info;
	_tmp7_ = camel_message_info_get_from (_tmp6_);
	_tmp8_ = _tmp7_;
	camel_address_unformat ((CamelAddress*) _tmp5_, _tmp8_);
	_tmp9_ = camel_address;
	camel_internet_address_get (_tmp9_, 0, &_tmp10_, &_tmp11_);
	parsed_name = _tmp10_;
	parsed_address = _tmp11_;
	_tmp12_ = parsed_name;
	if (_tmp12_ == NULL) {
		const gchar* _tmp13_;
		_tmp13_ = parsed_address;
		parsed_name = _tmp13_;
	}
	_tmp14_ = parsed_name;
	_tmp15_ = (HdyAvatar*) hdy_avatar_new (48, _tmp14_, TRUE);
	gtk_widget_set_valign ((GtkWidget*) _tmp15_, GTK_ALIGN_START);
	g_object_ref_sink (_tmp15_);
	_g_object_unref0 (self->priv->avatar);
	self->priv->avatar = _tmp15_;
	_tmp16_ = (GtkLabel*) gtk_label_new (_ ("From:"));
	g_object_ref_sink (_tmp16_);
	from_label = _tmp16_;
	_tmp17_ = from_label;
	gtk_widget_set_halign ((GtkWidget*) _tmp17_, GTK_ALIGN_END);
	_tmp18_ = from_label;
	gtk_widget_set_valign ((GtkWidget*) _tmp18_, GTK_ALIGN_START);
	_tmp19_ = from_label;
	_tmp20_ = gtk_widget_get_style_context ((GtkWidget*) _tmp19_);
	gtk_style_context_add_class (_tmp20_, GTK_STYLE_CLASS_DIM_LABEL);
	_tmp21_ = (GtkLabel*) gtk_label_new (_ ("To:"));
	g_object_ref_sink (_tmp21_);
	to_label = _tmp21_;
	_tmp22_ = to_label;
	gtk_widget_set_halign ((GtkWidget*) _tmp22_, GTK_ALIGN_END);
	_tmp23_ = to_label;
	gtk_widget_set_valign ((GtkWidget*) _tmp23_, GTK_ALIGN_START);
	_tmp24_ = to_label;
	_tmp25_ = gtk_widget_get_style_context ((GtkWidget*) _tmp24_);
	gtk_style_context_add_class (_tmp25_, GTK_STYLE_CLASS_DIM_LABEL);
	_tmp26_ = (GtkLabel*) gtk_label_new (_ ("Subject:"));
	g_object_ref_sink (_tmp26_);
	subject_label = _tmp26_;
	_tmp27_ = subject_label;
	gtk_widget_set_halign ((GtkWidget*) _tmp27_, GTK_ALIGN_END);
	_tmp28_ = subject_label;
	gtk_widget_set_valign ((GtkWidget*) _tmp28_, GTK_ALIGN_START);
	_tmp29_ = subject_label;
	_tmp30_ = gtk_widget_get_style_context ((GtkWidget*) _tmp29_);
	gtk_style_context_add_class (_tmp30_, GTK_STYLE_CLASS_DIM_LABEL);
	_tmp31_ = self->priv->_message_info;
	_tmp32_ = camel_message_info_get_from (_tmp31_);
	_tmp33_ = _tmp32_;
	_tmp34_ = (GtkLabel*) gtk_label_new (_tmp33_);
	g_object_ref_sink (_tmp34_);
	from_val_label = _tmp34_;
	_tmp35_ = from_val_label;
	g_object_set (_tmp35_, "wrap", TRUE, NULL);
	_tmp36_ = from_val_label;
	gtk_label_set_xalign (_tmp36_, (gfloat) 0);
	_tmp37_ = self->priv->_message_info;
	_tmp38_ = camel_message_info_get_to (_tmp37_);
	_tmp39_ = _tmp38_;
	_tmp40_ = (GtkLabel*) gtk_label_new (_tmp39_);
	g_object_ref_sink (_tmp40_);
	to_val_label = _tmp40_;
	_tmp41_ = to_val_label;
	g_object_set (_tmp41_, "wrap", TRUE, NULL);
	_tmp42_ = to_val_label;
	gtk_label_set_xalign (_tmp42_, (gfloat) 0);
	_tmp43_ = self->priv->_message_info;
	_tmp44_ = camel_message_info_get_subject (_tmp43_);
	_tmp45_ = _tmp44_;
	_tmp46_ = (GtkLabel*) gtk_label_new (_tmp45_);
	g_object_ref_sink (_tmp46_);
	subject_val_label = _tmp46_;
	_tmp47_ = subject_val_label;
	gtk_label_set_xalign (_tmp47_, (gfloat) 0);
	_tmp48_ = subject_val_label;
	g_object_set (_tmp48_, "wrap", TRUE, NULL);
	_tmp49_ = (GtkGrid*) gtk_grid_new ();
	g_object_ref_sink (_tmp49_);
	fields_grid = _tmp49_;
	_tmp50_ = fields_grid;
	gtk_grid_set_column_spacing (_tmp50_, 6);
	_tmp51_ = fields_grid;
	gtk_grid_set_row_spacing (_tmp51_, 6);
	_tmp52_ = fields_grid;
	_tmp53_ = from_label;
	gtk_grid_attach (_tmp52_, (GtkWidget*) _tmp53_, 0, 0, 1, 1);
	_tmp54_ = fields_grid;
	_tmp55_ = to_label;
	gtk_grid_attach (_tmp54_, (GtkWidget*) _tmp55_, 0, 1, 1, 1);
	_tmp56_ = fields_grid;
	_tmp57_ = subject_label;
	gtk_grid_attach (_tmp56_, (GtkWidget*) _tmp57_, 0, 3, 1, 1);
	_tmp58_ = fields_grid;
	_tmp59_ = from_val_label;
	gtk_grid_attach (_tmp58_, (GtkWidget*) _tmp59_, 1, 0, 1, 1);
	_tmp60_ = fields_grid;
	_tmp61_ = to_val_label;
	gtk_grid_attach (_tmp60_, (GtkWidget*) _tmp61_, 1, 1, 1, 1);
	_tmp62_ = fields_grid;
	_tmp63_ = subject_val_label;
	gtk_grid_attach (_tmp62_, (GtkWidget*) _tmp63_, 1, 3, 1, 1);
	_tmp64_ = self->priv->_message_info;
	_tmp65_ = camel_message_info_get_cc (_tmp64_);
	_tmp66_ = _tmp65_;
	_tmp67_ = g_strdup (_tmp66_);
	cc_info = _tmp67_;
	_tmp68_ = cc_info;
	if (_tmp68_ != NULL) {
		GtkLabel* cc_label = NULL;
		GtkLabel* _tmp69_;
		GtkLabel* _tmp70_;
		GtkLabel* _tmp71_;
		GtkLabel* _tmp72_;
		GtkStyleContext* _tmp73_;
		GtkLabel* cc_val_label = NULL;
		const gchar* _tmp74_;
		GtkLabel* _tmp75_;
		GtkLabel* _tmp76_;
		GtkLabel* _tmp77_;
		GtkGrid* _tmp78_;
		GtkLabel* _tmp79_;
		GtkGrid* _tmp80_;
		GtkLabel* _tmp81_;
		_tmp69_ = (GtkLabel*) gtk_label_new (_ ("Cc:"));
		g_object_ref_sink (_tmp69_);
		cc_label = _tmp69_;
		_tmp70_ = cc_label;
		gtk_widget_set_halign ((GtkWidget*) _tmp70_, GTK_ALIGN_END);
		_tmp71_ = cc_label;
		gtk_widget_set_valign ((GtkWidget*) _tmp71_, GTK_ALIGN_START);
		_tmp72_ = cc_label;
		_tmp73_ = gtk_widget_get_style_context ((GtkWidget*) _tmp72_);
		gtk_style_context_add_class (_tmp73_, GTK_STYLE_CLASS_DIM_LABEL);
		_tmp74_ = cc_info;
		_tmp75_ = (GtkLabel*) gtk_label_new (_tmp74_);
		g_object_ref_sink (_tmp75_);
		cc_val_label = _tmp75_;
		_tmp76_ = cc_val_label;
		gtk_label_set_xalign (_tmp76_, (gfloat) 0);
		_tmp77_ = cc_val_label;
		g_object_set (_tmp77_, "wrap", TRUE, NULL);
		_tmp78_ = fields_grid;
		_tmp79_ = cc_label;
		gtk_grid_attach (_tmp78_, (GtkWidget*) _tmp79_, 0, 2, 1, 1);
		_tmp80_ = fields_grid;
		_tmp81_ = cc_val_label;
		gtk_grid_attach (_tmp80_, (GtkWidget*) _tmp81_, 1, 2, 1, 1);
		_g_object_unref0 (cc_val_label);
		_g_object_unref0 (cc_label);
	}
	_tmp82_ = self->priv->_message_info;
	_tmp83_ = camel_message_info_get_from (_tmp82_);
	_tmp84_ = _tmp83_;
	_tmp85_ = (GtkLabel*) gtk_label_new (_tmp84_);
	g_object_ref_sink (_tmp85_);
	small_from_label = _tmp85_;
	_tmp86_ = from_val_label;
	gtk_label_set_ellipsize (_tmp86_, PANGO_ELLIPSIZE_END);
	_tmp87_ = from_val_label;
	gtk_label_set_xalign (_tmp87_, (gfloat) 0);
	_tmp88_ = (GtkGrid*) gtk_grid_new ();
	g_object_ref_sink (_tmp88_);
	small_fields_grid = _tmp88_;
	_tmp89_ = small_fields_grid;
	_tmp90_ = small_from_label;
	gtk_grid_attach (_tmp89_, (GtkWidget*) _tmp90_, 0, 0, 1, 1);
	_tmp91_ = (GtkStack*) gtk_stack_new ();
	g_object_ref_sink (_tmp91_);
	_g_object_unref0 (self->priv->header_stack);
	self->priv->header_stack = _tmp91_;
	_tmp92_ = self->priv->header_stack;
	gtk_stack_set_homogeneous (_tmp92_, FALSE);
	_tmp93_ = self->priv->header_stack;
	gtk_stack_set_transition_type (_tmp93_, GTK_STACK_TRANSITION_TYPE_CROSSFADE);
	_tmp94_ = self->priv->header_stack;
	_tmp95_ = fields_grid;
	gtk_stack_add_named (_tmp94_, (GtkWidget*) _tmp95_, "large");
	_tmp96_ = self->priv->header_stack;
	_tmp97_ = small_fields_grid;
	gtk_stack_add_named (_tmp96_, (GtkWidget*) _tmp97_, "small");
	_tmp98_ = self->priv->header_stack;
	gtk_widget_show_all ((GtkWidget*) _tmp98_);
	_tmp99_ = self->priv->_message_info;
	_tmp100_ = camel_message_info_get_date_received (_tmp99_);
	_tmp101_ = _tmp100_;
	relevant_timestamp = _tmp101_;
	if (relevant_timestamp == ((gint64) 0)) {
		CamelMessageInfo* _tmp102_;
		gint64 _tmp103_;
		gint64 _tmp104_;
		_tmp102_ = self->priv->_message_info;
		_tmp103_ = camel_message_info_get_date_sent (_tmp102_);
		_tmp104_ = _tmp103_;
		relevant_timestamp = _tmp104_;
	}
	_tmp105_ = granite_date_time_get_default_date_format (FALSE, TRUE, TRUE);
	date_format = _tmp105_;
	_tmp106_ = mail_message_list_item_desktop_settings;
	_tmp107_ = granite_date_time_get_default_time_format (g_settings_get_enum (_tmp106_, "clock-format") == 1, FALSE);
	time_format = _tmp107_;
	_tmp108_ = g_date_time_new_from_unix_utc (relevant_timestamp);
	_tmp109_ = _tmp108_;
	_tmp110_ = g_date_time_to_local (_tmp109_);
	_tmp111_ = _tmp110_;
	_tmp112_ = date_format;
	_tmp113_ = time_format;
	_tmp114_ = g_strdup_printf (_ ("%s at %s"), _tmp112_, _tmp113_);
	_tmp115_ = _tmp114_;
	_tmp116_ = g_date_time_format (_tmp111_, _tmp115_);
	_tmp117_ = _tmp116_;
	_tmp118_ = (GtkLabel*) gtk_label_new (_tmp117_);
	g_object_ref_sink (_tmp118_);
	_tmp119_ = _tmp118_;
	_g_free0 (_tmp117_);
	_g_free0 (_tmp115_);
	_g_date_time_unref0 (_tmp111_);
	_g_date_time_unref0 (_tmp109_);
	datetime_label = _tmp119_;
	_tmp120_ = datetime_label;
	_tmp121_ = gtk_widget_get_style_context ((GtkWidget*) _tmp120_);
	gtk_style_context_add_class (_tmp121_, GTK_STYLE_CLASS_DIM_LABEL);
	_tmp122_ = (GtkImage*) gtk_image_new ();
	g_object_ref_sink (_tmp122_);
	_data32_->starred_icon = _tmp122_;
	_tmp123_ = _data32_->starred_icon;
	g_object_set (_tmp123_, "icon-size", (gint) GTK_ICON_SIZE_MENU, NULL);
	_tmp124_ = self->priv->_message_info;
	g_object_get (_tmp124_, "flags", &_tmp125_, NULL);
	_tmp126_ = _tmp125_;
	if ((((gint) _tmp126_) & CAMEL_MESSAGE_FLAGGED) == CAMEL_MESSAGE_FLAGGED) {
		GtkImage* _tmp127_;
		GtkImage* _tmp128_;
		_tmp127_ = _data32_->starred_icon;
		g_object_set (_tmp127_, "icon-name", "starred-symbolic", NULL);
		_tmp128_ = _data32_->starred_icon;
		gtk_widget_set_tooltip_text ((GtkWidget*) _tmp128_, _ ("Unstar message"));
	} else {
		GtkImage* _tmp129_;
		GtkImage* _tmp130_;
		_tmp129_ = _data32_->starred_icon;
		g_object_set (_tmp129_, "icon-name", "non-starred-symbolic", NULL);
		_tmp130_ = _data32_->starred_icon;
		gtk_widget_set_tooltip_text ((GtkWidget*) _tmp130_, _ ("Star message"));
	}
	_tmp131_ = (GtkButton*) gtk_button_new ();
	g_object_ref_sink (_tmp131_);
	starred_button = _tmp131_;
	_tmp132_ = starred_button;
	_tmp133_ = _data32_->starred_icon;
	gtk_button_set_image (_tmp132_, (GtkWidget*) _tmp133_);
	_tmp134_ = starred_button;
	_tmp135_ = gtk_widget_get_style_context ((GtkWidget*) _tmp134_);
	gtk_style_context_add_class (_tmp135_, GTK_STYLE_CLASS_FLAT);
	_tmp136_ = (GtkMenuItem*) gtk_menu_item_new_with_label (_ ("Reply"));
	g_object_ref_sink (_tmp136_);
	reply_item = _tmp136_;
	_tmp137_ = reply_item;
	g_signal_connect_object (_tmp137_, "activate", (GCallback) __mail_message_list_item___lambda82__gtk_menu_item_activate, self, 0);
	_tmp138_ = (GtkMenuItem*) gtk_menu_item_new_with_label (_ ("Reply to All"));
	g_object_ref_sink (_tmp138_);
	reply_all_item = _tmp138_;
	_tmp139_ = reply_all_item;
	g_signal_connect_object (_tmp139_, "activate", (GCallback) __mail_message_list_item___lambda83__gtk_menu_item_activate, self, 0);
	_tmp140_ = (GtkMenuItem*) gtk_menu_item_new_with_label (_ ("Forward"));
	g_object_ref_sink (_tmp140_);
	forward_item = _tmp140_;
	_tmp141_ = forward_item;
	g_signal_connect_object (_tmp141_, "activate", (GCallback) __mail_message_list_item___lambda84__gtk_menu_item_activate, self, 0);
	_tmp142_ = (GtkMenuItem*) gtk_menu_item_new_with_label (_ ("Print…"));
	g_object_ref_sink (_tmp142_);
	print_item = _tmp142_;
	_tmp143_ = print_item;
	g_signal_connect_object (_tmp143_, "activate", (GCallback) _mail_message_list_item_on_print_gtk_menu_item_activate, self, 0);
	_tmp144_ = (GtkMenu*) gtk_menu_new ();
	g_object_ref_sink (_tmp144_);
	actions_menu = _tmp144_;
	_tmp145_ = actions_menu;
	_tmp146_ = reply_item;
	gtk_container_add ((GtkContainer*) _tmp145_, (GtkWidget*) _tmp146_);
	_tmp147_ = actions_menu;
	_tmp148_ = reply_all_item;
	gtk_container_add ((GtkContainer*) _tmp147_, (GtkWidget*) _tmp148_);
	_tmp149_ = actions_menu;
	_tmp150_ = forward_item;
	gtk_container_add ((GtkContainer*) _tmp149_, (GtkWidget*) _tmp150_);
	_tmp151_ = actions_menu;
	_tmp152_ = (GtkSeparatorMenuItem*) gtk_separator_menu_item_new ();
	g_object_ref_sink (_tmp152_);
	_tmp153_ = _tmp152_;
	gtk_container_add ((GtkContainer*) _tmp151_, (GtkWidget*) _tmp153_);
	_g_object_unref0 (_tmp153_);
	_tmp154_ = actions_menu;
	_tmp155_ = print_item;
	gtk_container_add ((GtkContainer*) _tmp154_, (GtkWidget*) _tmp155_);
	_tmp156_ = actions_menu;
	gtk_widget_show_all ((GtkWidget*) _tmp156_);
	_tmp157_ = (GtkMenuButton*) gtk_menu_button_new ();
	g_object_ref_sink (_tmp157_);
	_data32_->actions_menu_button = _tmp157_;
	_tmp158_ = _data32_->actions_menu_button;
	_tmp159_ = (GtkImage*) gtk_image_new_from_icon_name ("view-more-symbolic", (GtkIconSize) GTK_ICON_SIZE_MENU);
	g_object_ref_sink (_tmp159_);
	_tmp160_ = _tmp159_;
	gtk_button_set_image ((GtkButton*) _tmp158_, (GtkWidget*) _tmp160_);
	_g_object_unref0 (_tmp160_);
	_tmp161_ = _data32_->actions_menu_button;
	_tmp162_ = gtk_widget_get_style_context ((GtkWidget*) _tmp161_);
	gtk_style_context_add_class (_tmp162_, GTK_STYLE_CLASS_FLAT);
	_tmp163_ = _data32_->actions_menu_button;
	gtk_widget_set_tooltip_text ((GtkWidget*) _tmp163_, _ ("More"));
	_tmp164_ = _data32_->actions_menu_button;
	gtk_widget_set_margin_top ((GtkWidget*) _tmp164_, 6);
	_tmp165_ = _data32_->actions_menu_button;
	gtk_widget_set_valign ((GtkWidget*) _tmp165_, GTK_ALIGN_START);
	_tmp166_ = _data32_->actions_menu_button;
	gtk_widget_set_halign ((GtkWidget*) _tmp166_, GTK_ALIGN_END);
	_tmp167_ = _data32_->actions_menu_button;
	_tmp168_ = actions_menu;
	gtk_menu_button_set_popup (_tmp167_, _tmp168_);
	_tmp169_ = (GtkGrid*) gtk_grid_new ();
	g_object_ref_sink (_tmp169_);
	action_grid = _tmp169_;
	_tmp170_ = action_grid;
	gtk_grid_set_column_spacing (_tmp170_, 3);
	_tmp171_ = action_grid;
	gtk_widget_set_hexpand ((GtkWidget*) _tmp171_, TRUE);
	_tmp172_ = action_grid;
	gtk_widget_set_halign ((GtkWidget*) _tmp172_, GTK_ALIGN_END);
	_tmp173_ = action_grid;
	gtk_widget_set_valign ((GtkWidget*) _tmp173_, GTK_ALIGN_START);
	_tmp174_ = action_grid;
	_tmp175_ = datetime_label;
	gtk_container_add ((GtkContainer*) _tmp174_, (GtkWidget*) _tmp175_);
	_tmp176_ = action_grid;
	_tmp177_ = starred_button;
	gtk_grid_attach (_tmp176_, (GtkWidget*) _tmp177_, 2, 0, 1, 1);
	_tmp178_ = action_grid;
	_tmp179_ = _data32_->actions_menu_button;
	gtk_grid_attach (_tmp178_, (GtkWidget*) _tmp179_, 2, 1, 1, 1);
	_tmp180_ = (GtkGrid*) gtk_grid_new ();
	g_object_ref_sink (_tmp180_);
	header = _tmp180_;
	_tmp181_ = header;
	g_object_set ((GtkWidget*) _tmp181_, "margin", 12, NULL);
	_tmp182_ = header;
	gtk_grid_set_column_spacing (_tmp182_, 12);
	_tmp183_ = header;
	_tmp184_ = self->priv->avatar;
	gtk_grid_attach (_tmp183_, (GtkWidget*) _tmp184_, 0, 0, 1, 3);
	_tmp185_ = header;
	_tmp186_ = self->priv->header_stack;
	gtk_grid_attach (_tmp185_, (GtkWidget*) _tmp186_, 1, 0, 1, 3);
	_tmp187_ = header;
	_tmp188_ = action_grid;
	gtk_grid_attach (_tmp187_, (GtkWidget*) _tmp188_, 2, 0, 1, 1);
	_tmp189_ = (GtkEventBox*) gtk_event_box_new ();
	g_object_ref_sink (_tmp189_);
	_data32_->header_event_box = _tmp189_;
	_tmp190_ = _data32_->header_event_box;
	_tmp191_ = _data32_->header_event_box;
	_tmp192_ = gtk_widget_get_events ((GtkWidget*) _tmp191_);
	_tmp193_ = _tmp192_;
	gtk_widget_set_events ((GtkWidget*) _tmp191_, _tmp193_ | GDK_ENTER_NOTIFY_MASK);
	_tmp194_ = _data32_->header_event_box;
	_tmp195_ = _data32_->header_event_box;
	_tmp196_ = gtk_widget_get_events ((GtkWidget*) _tmp195_);
	_tmp197_ = _tmp196_;
	gtk_widget_set_events ((GtkWidget*) _tmp195_, _tmp197_ | GDK_LEAVE_NOTIFY_MASK);
	_tmp198_ = _data32_->header_event_box;
	_tmp199_ = _data32_->header_event_box;
	_tmp200_ = gtk_widget_get_events ((GtkWidget*) _tmp199_);
	_tmp201_ = _tmp200_;
	gtk_widget_set_events ((GtkWidget*) _tmp199_, _tmp201_ | GDK_BUTTON_RELEASE_MASK);
	_tmp202_ = _data32_->header_event_box;
	_tmp203_ = header;
	gtk_container_add ((GtkContainer*) _tmp202_, (GtkWidget*) _tmp203_);
	_tmp204_ = (GtkSeparator*) gtk_separator_new (GTK_ORIENTATION_HORIZONTAL);
	g_object_ref_sink (_tmp204_);
	separator = _tmp204_;
	_tmp205_ = separator;
	gtk_widget_set_hexpand ((GtkWidget*) _tmp205_, TRUE);
	_tmp206_ = g_settings_new ("io.elementary.mail");
	_g_object_unref0 (self->priv->settings);
	self->priv->settings = _tmp206_;
	_tmp207_ = (GtkInfoBar*) gtk_info_bar_new ();
	g_object_ref_sink (_tmp207_);
	_g_object_unref0 (self->priv->blocked_images_infobar);
	self->priv->blocked_images_infobar = _tmp207_;
	_tmp208_ = self->priv->blocked_images_infobar;
	g_object_set ((GtkWidget*) _tmp208_, "margin", 12, NULL);
	_tmp209_ = self->priv->blocked_images_infobar;
	gtk_info_bar_set_message_type (_tmp209_, GTK_MESSAGE_WARNING);
	_tmp210_ = self->priv->blocked_images_infobar;
	gtk_info_bar_add_button (_tmp210_, _ ("Show Images"), 1);
	_tmp211_ = self->priv->blocked_images_infobar;
	gtk_info_bar_add_button (_tmp211_, _ ("Always Show from Sender"), 2);
	_tmp212_ = self->priv->blocked_images_infobar;
	_tmp213_ = gtk_widget_get_style_context ((GtkWidget*) _tmp212_);
	gtk_style_context_add_class (_tmp213_, GTK_STYLE_CLASS_FRAME);
	_tmp214_ = self->priv->blocked_images_infobar;
	gtk_widget_set_no_show_all ((GtkWidget*) _tmp214_, TRUE);
	_tmp215_ = self->priv->blocked_images_infobar;
	_tmp216_ = gtk_info_bar_get_content_area (_tmp215_);
	_tmp217_ = _g_object_ref0 (_tmp216_);
	infobar_content = _tmp217_;
	_tmp218_ = infobar_content;
	_tmp219_ = (GtkLabel*) gtk_label_new (_ ("This message contains remote images."));
	g_object_ref_sink (_tmp219_);
	_tmp220_ = _tmp219_;
	gtk_container_add (_tmp218_, (GtkWidget*) _tmp220_);
	_g_object_unref0 (_tmp220_);
	_tmp221_ = infobar_content;
	gtk_widget_show_all ((GtkWidget*) _tmp221_);
	_tmp222_ = self->priv->blocked_images_infobar;
	_tmp223_ = gtk_info_bar_get_action_area (_tmp222_);
	gtk_orientable_set_orientation ((GtkOrientable*) G_TYPE_CHECK_INSTANCE_CAST (_tmp223_, gtk_box_get_type (), GtkBox), GTK_ORIENTATION_VERTICAL);
	_tmp224_ = mail_web_view_new ();
	g_object_ref_sink (_tmp224_);
	_g_object_unref0 (self->priv->web_view);
	self->priv->web_view = _tmp224_;
	_tmp225_ = self->priv->web_view;
	g_object_set ((GtkWidget*) _tmp225_, "margin", 12, NULL);
	_tmp226_ = self->priv->web_view;
	g_signal_connect_object ((WebKitWebView*) _tmp226_, "mouse-target-changed", (GCallback) _mail_message_list_item_on_mouse_target_changed_webkit_web_view_mouse_target_changed, self, 0);
	_tmp227_ = self->priv->web_view;
	g_signal_connect_object ((WebKitWebView*) _tmp227_, "context-menu", (GCallback) _mail_message_list_item_on_webview_context_menu_webkit_web_view_context_menu, self, 0);
	_tmp228_ = self->priv->web_view;
	g_signal_connect_object (_tmp228_, "load-finished", (GCallback) __mail_message_list_item___lambda85__mail_web_view_load_finished, self, 0);
	_tmp229_ = (GtkGrid*) gtk_grid_new ();
	g_object_ref_sink (_tmp229_);
	secondary_grid = _tmp229_;
	_tmp230_ = secondary_grid;
	gtk_orientable_set_orientation ((GtkOrientable*) _tmp230_, GTK_ORIENTATION_VERTICAL);
	_tmp231_ = secondary_grid;
	_tmp232_ = separator;
	gtk_container_add ((GtkContainer*) _tmp231_, (GtkWidget*) _tmp232_);
	_tmp233_ = secondary_grid;
	_tmp234_ = self->priv->blocked_images_infobar;
	gtk_container_add ((GtkContainer*) _tmp233_, (GtkWidget*) _tmp234_);
	_tmp235_ = secondary_grid;
	_tmp236_ = self->priv->web_view;
	gtk_container_add ((GtkContainer*) _tmp235_, (GtkWidget*) _tmp236_);
	_tmp237_ = (GtkRevealer*) gtk_revealer_new ();
	g_object_ref_sink (_tmp237_);
	_g_object_unref0 (self->priv->secondary_revealer);
	self->priv->secondary_revealer = _tmp237_;
	_tmp238_ = self->priv->secondary_revealer;
	gtk_revealer_set_transition_type (_tmp238_, GTK_REVEALER_TRANSITION_TYPE_SLIDE_UP);
	_tmp239_ = self->priv->secondary_revealer;
	_tmp240_ = secondary_grid;
	gtk_container_add ((GtkContainer*) _tmp239_, (GtkWidget*) _tmp240_);
	_tmp241_ = (GtkGrid*) gtk_grid_new ();
	g_object_ref_sink (_tmp241_);
	base_grid = _tmp241_;
	_tmp242_ = base_grid;
	g_object_set ((GtkWidget*) _tmp242_, "expand", TRUE, NULL);
	_tmp243_ = base_grid;
	gtk_orientable_set_orientation ((GtkOrientable*) _tmp243_, GTK_ORIENTATION_VERTICAL);
	_tmp244_ = base_grid;
	_tmp245_ = _data32_->header_event_box;
	gtk_container_add ((GtkContainer*) _tmp244_, (GtkWidget*) _tmp245_);
	_tmp246_ = base_grid;
	_tmp247_ = self->priv->secondary_revealer;
	gtk_container_add ((GtkContainer*) _tmp246_, (GtkWidget*) _tmp247_);
	_tmp248_ = self->priv->_message_info;
	g_object_get (_tmp248_, "flags", &_tmp249_, NULL);
	_tmp250_ = _tmp249_;
	if ((((gint) _tmp250_) & CAMEL_MESSAGE_ATTACHMENTS) == CAMEL_MESSAGE_ATTACHMENTS) {
		GtkImage* attachment_icon = NULL;
		GtkImage* _tmp251_;
		GtkImage* _tmp252_;
		GtkImage* _tmp253_;
		GtkGrid* _tmp254_;
		GtkImage* _tmp255_;
		GCancellable* _tmp256_;
		MailAttachmentBar* _tmp257_;
		GtkGrid* _tmp258_;
		MailAttachmentBar* _tmp259_;
		_tmp251_ = (GtkImage*) gtk_image_new_from_icon_name ("mail-attachment-symbolic", (GtkIconSize) GTK_ICON_SIZE_MENU);
		g_object_ref_sink (_tmp251_);
		attachment_icon = _tmp251_;
		_tmp252_ = attachment_icon;
		gtk_widget_set_margin_start ((GtkWidget*) _tmp252_, 6);
		_tmp253_ = attachment_icon;
		gtk_widget_set_tooltip_text ((GtkWidget*) _tmp253_, _ ("This message contains one or more attachments"));
		_tmp254_ = action_grid;
		_tmp255_ = attachment_icon;
		gtk_grid_attach (_tmp254_, (GtkWidget*) _tmp255_, 1, 0, 1, 1);
		_tmp256_ = self->priv->loading_cancellable;
		_tmp257_ = mail_attachment_bar_new (_tmp256_);
		g_object_ref_sink (_tmp257_);
		_g_object_unref0 (self->priv->attachment_bar);
		self->priv->attachment_bar = _tmp257_;
		_tmp258_ = secondary_grid;
		_tmp259_ = self->priv->attachment_bar;
		gtk_container_add ((GtkContainer*) _tmp258_, (GtkWidget*) _tmp259_);
		_g_object_unref0 (attachment_icon);
	}
	_tmp260_ = base_grid;
	gtk_container_add ((GtkContainer*) self, (GtkWidget*) _tmp260_);
	mail_message_list_item_set_expanded (self, FALSE);
	gtk_widget_show_all ((GtkWidget*) self);
	_tmp261_ = self->priv->avatar;
	_tmp262_ = parsed_address;
	_tmp263_ = gtk_widget_get_style_context ((GtkWidget*) self);
	_tmp264_ = gravatar_icon_new (_tmp262_, gtk_style_context_get_scale (_tmp263_));
	_tmp265_ = _tmp264_;
	hdy_avatar_set_loadable_icon (_tmp261_, (GLoadableIcon*) _tmp265_);
	_g_object_unref0 (_tmp265_);
	_tmp266_ = _data32_->actions_menu_button;
	g_signal_connect_data ((GtkWidget*) _tmp266_, "button-release-event", (GCallback) __mail_message_list_item___lambda86__gtk_widget_button_release_event, block32_data_ref (_data32_), (GClosureNotify) block32_data_unref, 0);
	_tmp267_ = _data32_->header_event_box;
	g_signal_connect_data ((GtkWidget*) _tmp267_, "enter-notify-event", (GCallback) __mail_message_list_item___lambda87__gtk_widget_enter_notify_event, block32_data_ref (_data32_), (GClosureNotify) block32_data_unref, 0);
	_tmp268_ = _data32_->header_event_box;
	g_signal_connect_data ((GtkWidget*) _tmp268_, "leave-notify-event", (GCallback) __mail_message_list_item___lambda88__gtk_widget_leave_notify_event, block32_data_ref (_data32_), (GClosureNotify) block32_data_unref, 0);
	_tmp269_ = _data32_->header_event_box;
	g_signal_connect_object ((GtkWidget*) _tmp269_, "button-release-event", (GCallback) __mail_message_list_item___lambda89__gtk_widget_button_release_event, self, 0);
	g_signal_connect_object ((GtkWidget*) self, "destroy", (GCallback) __mail_message_list_item___lambda90__gtk_widget_destroy, self, 0);
	_tmp270_ = starred_button;
	g_signal_connect_data ((GtkWidget*) _tmp270_, "button-release-event", (GCallback) __mail_message_list_item___lambda91__gtk_widget_button_release_event, block32_data_ref (_data32_), (GClosureNotify) block32_data_unref, 0);
	_tmp271_ = self->priv->web_view;
	g_signal_connect_object (_tmp271_, "image-load-blocked", (GCallback) __mail_message_list_item___lambda92__mail_web_view_image_load_blocked, self, 0);
	_tmp272_ = self->priv->web_view;
	g_signal_connect_object (_tmp272_, "link-activated", (GCallback) __mail_message_list_item___lambda93__mail_web_view_link_activated, self, 0);
	_g_object_unref0 (base_grid);
	_g_object_unref0 (secondary_grid);
	_g_object_unref0 (infobar_content);
	_g_object_unref0 (separator);
	_g_object_unref0 (header);
	_g_object_unref0 (action_grid);
	_g_object_unref0 (actions_menu);
	_g_object_unref0 (print_item);
	_g_object_unref0 (forward_item);
	_g_object_unref0 (reply_all_item);
	_g_object_unref0 (reply_item);
	_g_object_unref0 (starred_button);
	_g_object_unref0 (datetime_label);
	_g_free0 (time_format);
	_g_free0 (date_format);
	_g_object_unref0 (small_fields_grid);
	_g_object_unref0 (small_from_label);
	_g_free0 (cc_info);
	_g_object_unref0 (fields_grid);
	_g_object_unref0 (subject_val_label);
	_g_object_unref0 (to_val_label);
	_g_object_unref0 (from_val_label);
	_g_object_unref0 (subject_label);
	_g_object_unref0 (to_label);
	_g_object_unref0 (from_label);
	_g_object_unref0 (camel_address);
	block32_data_unref (_data32_);
	_data32_ = NULL;
	return obj;
}

static void
mail_message_list_item_class_init (MailMessageListItemClass * klass,
                                   gpointer klass_data)
{
	GeeHashMap* _tmp0_;
	GSettings* _tmp1_;
	mail_message_list_item_parent_class = g_type_class_peek_parent (klass);
	g_type_class_adjust_private_offset (klass, &MailMessageListItem_private_offset);
	G_OBJECT_CLASS (klass)->get_property = _vala_mail_message_list_item_get_property;
	G_OBJECT_CLASS (klass)->set_property = _vala_mail_message_list_item_set_property;
	G_OBJECT_CLASS (klass)->constructor = mail_message_list_item_constructor;
	G_OBJECT_CLASS (klass)->finalize = mail_message_list_item_finalize;
	g_object_class_install_property (G_OBJECT_CLASS (klass), MAIL_MESSAGE_LIST_ITEM_LOADED_PROPERTY, mail_message_list_item_properties[MAIL_MESSAGE_LIST_ITEM_LOADED_PROPERTY] = g_param_spec_boolean ("loaded", "loaded", "loaded", FALSE, G_PARAM_STATIC_STRINGS | G_PARAM_READABLE));
	g_object_class_install_property (G_OBJECT_CLASS (klass), MAIL_MESSAGE_LIST_ITEM_MESSAGE_INFO_PROPERTY, mail_message_list_item_properties[MAIL_MESSAGE_LIST_ITEM_MESSAGE_INFO_PROPERTY] = g_param_spec_object ("message-info", "message-info", "message-info", camel_message_info_get_type (), G_PARAM_STATIC_STRINGS | G_PARAM_READABLE | G_PARAM_WRITABLE | G_PARAM_CONSTRUCT_ONLY));
	g_object_class_install_property (G_OBJECT_CLASS (klass), MAIL_MESSAGE_LIST_ITEM_MIME_MESSAGE_PROPERTY, mail_message_list_item_properties[MAIL_MESSAGE_LIST_ITEM_MIME_MESSAGE_PROPERTY] = g_param_spec_object ("mime-message", "mime-message", "mime-message", camel_mime_message_get_type (), G_PARAM_STATIC_STRINGS | G_PARAM_READABLE));
	g_object_class_install_property (G_OBJECT_CLASS (klass), MAIL_MESSAGE_LIST_ITEM_EXPANDED_PROPERTY, mail_message_list_item_properties[MAIL_MESSAGE_LIST_ITEM_EXPANDED_PROPERTY] = g_param_spec_boolean ("expanded", "expanded", "expanded", FALSE, G_PARAM_STATIC_STRINGS | G_PARAM_READABLE | G_PARAM_WRITABLE));
	_tmp0_ = gee_hash_map_new (G_TYPE_STRING, (GBoxedCopyFunc) g_strdup, (GDestroyNotify) g_free, gdk_pixbuf_get_type (), (GBoxedCopyFunc) g_object_ref, (GDestroyNotify) g_object_unref, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL, NULL);
	_g_object_unref0 (mail_message_list_item_avatars);
	mail_message_list_item_avatars = _tmp0_;
	_tmp1_ = g_settings_new ("org.gnome.desktop.interface");
	_g_object_unref0 (mail_message_list_item_desktop_settings);
	mail_message_list_item_desktop_settings = _tmp1_;
}

static void
mail_message_list_item_instance_init (MailMessageListItem * self,
                                      gpointer klass)
{
	self->priv = mail_message_list_item_get_instance_private (self);
	self->priv->_mime_message = NULL;
	self->priv->attachment_bar = NULL;
	self->priv->message_is_html = FALSE;
	self->priv->message_loaded = FALSE;
}

static void
mail_message_list_item_finalize (GObject * obj)
{
	MailMessageListItem * self;
	self = G_TYPE_CHECK_INSTANCE_CAST (obj, MAIL_TYPE_MESSAGE_LIST_ITEM, MailMessageListItem);
	_g_object_unref0 (self->priv->_message_info);
	_g_object_unref0 (self->priv->_mime_message);
	_g_object_unref0 (self->priv->web_view);
	_g_object_unref0 (self->priv->loading_cancellable);
	_g_object_unref0 (self->priv->blocked_images_infobar);
	_g_object_unref0 (self->priv->secondary_revealer);
	_g_object_unref0 (self->priv->header_stack);
	_g_object_unref0 (self->priv->style_context);
	_g_object_unref0 (self->priv->avatar);
	_g_object_unref0 (self->priv->attachment_bar);
	_g_free0 (self->priv->message_content);
	_g_object_unref0 (self->priv->settings);
	G_OBJECT_CLASS (mail_message_list_item_parent_class)->finalize (obj);
}

static GType
mail_message_list_item_get_type_once (void)
{
	static const GTypeInfo g_define_type_info = { sizeof (MailMessageListItemClass), (GBaseInitFunc) NULL, (GBaseFinalizeFunc) NULL, (GClassInitFunc) mail_message_list_item_class_init, (GClassFinalizeFunc) NULL, NULL, sizeof (MailMessageListItem), 0, (GInstanceInitFunc) mail_message_list_item_instance_init, NULL };
	GType mail_message_list_item_type_id;
	mail_message_list_item_type_id = g_type_register_static (gtk_list_box_row_get_type (), "MailMessageListItem", &g_define_type_info, 0);
	MailMessageListItem_private_offset = g_type_add_instance_private (mail_message_list_item_type_id, sizeof (MailMessageListItemPrivate));
	return mail_message_list_item_type_id;
}

GType
mail_message_list_item_get_type (void)
{
	static volatile gsize mail_message_list_item_type_id__once = 0;
	if (g_once_init_enter (&mail_message_list_item_type_id__once)) {
		GType mail_message_list_item_type_id;
		mail_message_list_item_type_id = mail_message_list_item_get_type_once ();
		g_once_init_leave (&mail_message_list_item_type_id__once, mail_message_list_item_type_id);
	}
	return mail_message_list_item_type_id__once;
}

static void
_vala_mail_message_list_item_get_property (GObject * object,
                                           guint property_id,
                                           GValue * value,
                                           GParamSpec * pspec)
{
	MailMessageListItem * self;
	self = G_TYPE_CHECK_INSTANCE_CAST (object, MAIL_TYPE_MESSAGE_LIST_ITEM, MailMessageListItem);
	switch (property_id) {
		case MAIL_MESSAGE_LIST_ITEM_LOADED_PROPERTY:
		g_value_set_boolean (value, mail_message_list_item_get_loaded (self));
		break;
		case MAIL_MESSAGE_LIST_ITEM_MESSAGE_INFO_PROPERTY:
		g_value_set_object (value, mail_message_list_item_get_message_info (self));
		break;
		case MAIL_MESSAGE_LIST_ITEM_MIME_MESSAGE_PROPERTY:
		g_value_set_object (value, mail_message_list_item_get_mime_message (self));
		break;
		case MAIL_MESSAGE_LIST_ITEM_EXPANDED_PROPERTY:
		g_value_set_boolean (value, mail_message_list_item_get_expanded (self));
		break;
		default:
		G_OBJECT_WARN_INVALID_PROPERTY_ID (object, property_id, pspec);
		break;
	}
}

static void
_vala_mail_message_list_item_set_property (GObject * object,
                                           guint property_id,
                                           const GValue * value,
                                           GParamSpec * pspec)
{
	MailMessageListItem * self;
	self = G_TYPE_CHECK_INSTANCE_CAST (object, MAIL_TYPE_MESSAGE_LIST_ITEM, MailMessageListItem);
	switch (property_id) {
		case MAIL_MESSAGE_LIST_ITEM_LOADED_PROPERTY:
		mail_message_list_item_set_loaded (self, g_value_get_boolean (value));
		break;
		case MAIL_MESSAGE_LIST_ITEM_MESSAGE_INFO_PROPERTY:
		mail_message_list_item_set_message_info (self, g_value_get_object (value));
		break;
		case MAIL_MESSAGE_LIST_ITEM_MIME_MESSAGE_PROPERTY:
		mail_message_list_item_set_mime_message (self, g_value_get_object (value));
		break;
		case MAIL_MESSAGE_LIST_ITEM_EXPANDED_PROPERTY:
		mail_message_list_item_set_expanded (self, g_value_get_boolean (value));
		break;
		default:
		G_OBJECT_WARN_INVALID_PROPERTY_ID (object, property_id, pspec);
		break;
	}
}

static void
_vala_array_destroy (gpointer array,
                     gssize array_length,
                     GDestroyNotify destroy_func)
{
	if ((array != NULL) && (destroy_func != NULL)) {
		gssize i;
		for (i = 0; i < array_length; i = i + 1) {
			if (((gpointer*) array)[i] != NULL) {
				destroy_func (((gpointer*) array)[i]);
			}
		}
	}
}

static void
_vala_array_free (gpointer array,
                  gssize array_length,
                  GDestroyNotify destroy_func)
{
	_vala_array_destroy (array, array_length, destroy_func);
	g_free (array);
}

static gssize
_vala_array_length (gpointer array)
{
	gssize length;
	length = 0;
	if (array) {
		while (((gpointer*) array)[length]) {
			length++;
		}
	}
	return length;
}

