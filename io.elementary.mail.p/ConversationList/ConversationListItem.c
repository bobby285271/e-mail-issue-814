/* ConversationListItem.c generated by valac 0.56.3, the Vala compiler
 * generated from ConversationListItem.vala, do not modify */

/*-
 * Copyright (c) 2017 elementary LLC. (https://elementary.io)
 *
 * This library is free software; you can redistribute it and/or
 * modify it under the terms of the GNU Lesser General Public
 * License as published by the Free Software Foundation; either
 * version 3 of the License, or (at your option) any later version.
 *
 * This library is distributed in the hope that it will be useful,
 * but WITHOUT ANY WARRANTY; without even the implied warranty of
 * MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
 * Lesser General Public License for more details.
 *
 * You should have received a copy of the GNU Lesser General Public
 * License along with this library; if not, write to the
 * Free Software Foundation, Inc., 59 Temple Place - Suite 330,
 * Boston, MA 02111-1307, USA.
 *
 * Authored by: Corentin NoÃ«l <corentin@elementary.io>
 */

#include <gtk/gtk.h>
#include <glib-object.h>
#include <glib.h>
#include <stdlib.h>
#include <string.h>
#include <camel/camel.h>
#include <glib/gi18n-lib.h>
#include <granite.h>
#include <pango/pango.h>
#include <float.h>
#include <math.h>

#if !defined(VALA_EXTERN)
#if defined(_MSC_VER)
#define VALA_EXTERN __declspec(dllexport) extern
#elif __GNUC__ >= 4
#define VALA_EXTERN __attribute__((visibility("default"))) extern
#else
#define VALA_EXTERN extern
#endif
#endif

#define TYPE_VIRTUALIZING_LIST_BOX_ROW (virtualizing_list_box_row_get_type ())
#define VIRTUALIZING_LIST_BOX_ROW(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), TYPE_VIRTUALIZING_LIST_BOX_ROW, VirtualizingListBoxRow))
#define VIRTUALIZING_LIST_BOX_ROW_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), TYPE_VIRTUALIZING_LIST_BOX_ROW, VirtualizingListBoxRowClass))
#define IS_VIRTUALIZING_LIST_BOX_ROW(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), TYPE_VIRTUALIZING_LIST_BOX_ROW))
#define IS_VIRTUALIZING_LIST_BOX_ROW_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), TYPE_VIRTUALIZING_LIST_BOX_ROW))
#define VIRTUALIZING_LIST_BOX_ROW_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), TYPE_VIRTUALIZING_LIST_BOX_ROW, VirtualizingListBoxRowClass))

typedef struct _VirtualizingListBoxRow VirtualizingListBoxRow;
typedef struct _VirtualizingListBoxRowClass VirtualizingListBoxRowClass;
typedef struct _VirtualizingListBoxRowPrivate VirtualizingListBoxRowPrivate;

#define MAIL_TYPE_CONVERSATION_LIST_ITEM (mail_conversation_list_item_get_type ())
#define MAIL_CONVERSATION_LIST_ITEM(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), MAIL_TYPE_CONVERSATION_LIST_ITEM, MailConversationListItem))
#define MAIL_CONVERSATION_LIST_ITEM_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), MAIL_TYPE_CONVERSATION_LIST_ITEM, MailConversationListItemClass))
#define MAIL_IS_CONVERSATION_LIST_ITEM(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), MAIL_TYPE_CONVERSATION_LIST_ITEM))
#define MAIL_IS_CONVERSATION_LIST_ITEM_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), MAIL_TYPE_CONVERSATION_LIST_ITEM))
#define MAIL_CONVERSATION_LIST_ITEM_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), MAIL_TYPE_CONVERSATION_LIST_ITEM, MailConversationListItemClass))

typedef struct _MailConversationListItem MailConversationListItem;
typedef struct _MailConversationListItemClass MailConversationListItemClass;
typedef struct _MailConversationListItemPrivate MailConversationListItemPrivate;
enum  {
	MAIL_CONVERSATION_LIST_ITEM_0_PROPERTY,
	MAIL_CONVERSATION_LIST_ITEM_NUM_PROPERTIES
};
static GParamSpec* mail_conversation_list_item_properties[MAIL_CONVERSATION_LIST_ITEM_NUM_PROPERTIES];
#define _g_object_unref0(var) ((var == NULL) ? NULL : (var = (g_object_unref (var), NULL)))

#define MAIL_TYPE_CONVERSATION_ITEM_MODEL (mail_conversation_item_model_get_type ())
#define MAIL_CONVERSATION_ITEM_MODEL(obj) (G_TYPE_CHECK_INSTANCE_CAST ((obj), MAIL_TYPE_CONVERSATION_ITEM_MODEL, MailConversationItemModel))
#define MAIL_CONVERSATION_ITEM_MODEL_CLASS(klass) (G_TYPE_CHECK_CLASS_CAST ((klass), MAIL_TYPE_CONVERSATION_ITEM_MODEL, MailConversationItemModelClass))
#define MAIL_IS_CONVERSATION_ITEM_MODEL(obj) (G_TYPE_CHECK_INSTANCE_TYPE ((obj), MAIL_TYPE_CONVERSATION_ITEM_MODEL))
#define MAIL_IS_CONVERSATION_ITEM_MODEL_CLASS(klass) (G_TYPE_CHECK_CLASS_TYPE ((klass), MAIL_TYPE_CONVERSATION_ITEM_MODEL))
#define MAIL_CONVERSATION_ITEM_MODEL_GET_CLASS(obj) (G_TYPE_INSTANCE_GET_CLASS ((obj), MAIL_TYPE_CONVERSATION_ITEM_MODEL, MailConversationItemModelClass))

typedef struct _MailConversationItemModel MailConversationItemModel;
typedef struct _MailConversationItemModelClass MailConversationItemModelClass;
#define _g_free0(var) (var = (g_free (var), NULL))

struct _VirtualizingListBoxRow {
	GtkBin parent_instance;
	VirtualizingListBoxRowPrivate * priv;
};

struct _VirtualizingListBoxRowClass {
	GtkBinClass parent_class;
};

struct _MailConversationListItem {
	VirtualizingListBoxRow parent_instance;
	MailConversationListItemPrivate * priv;
};

struct _MailConversationListItemClass {
	VirtualizingListBoxRowClass parent_class;
};

struct _MailConversationListItemPrivate {
	GtkImage* status_icon;
	GtkLabel* date;
	GtkLabel* messages;
	GtkLabel* source;
	GtkLabel* topic;
	GtkRevealer* flagged_icon_revealer;
	GtkRevealer* status_revealer;
};

static gint MailConversationListItem_private_offset;
static gpointer mail_conversation_list_item_parent_class = NULL;

VALA_EXTERN GType virtualizing_list_box_row_get_type (void) G_GNUC_CONST ;
G_DEFINE_AUTOPTR_CLEANUP_FUNC (VirtualizingListBoxRow, g_object_unref)
VALA_EXTERN GType mail_conversation_list_item_get_type (void) G_GNUC_CONST ;
G_DEFINE_AUTOPTR_CLEANUP_FUNC (MailConversationListItem, g_object_unref)
VALA_EXTERN GType mail_conversation_item_model_get_type (void) G_GNUC_CONST ;
G_DEFINE_AUTOPTR_CLEANUP_FUNC (MailConversationItemModel, g_object_unref)
VALA_EXTERN void mail_conversation_list_item_assign (MailConversationListItem* self,
                                         MailConversationItemModel* data);
VALA_EXTERN gchar* mail_conversation_item_model_get_formatted_date (MailConversationItemModel* self);
VALA_EXTERN const gchar* mail_conversation_item_model_get_subject (MailConversationItemModel* self);
VALA_EXTERN CamelFolderInfoFlags mail_conversation_item_model_get_folder_info_flags (MailConversationItemModel* self);
VALA_EXTERN gchar* mail_conversation_item_model_get_to (MailConversationItemModel* self);
VALA_EXTERN gchar* mail_conversation_item_model_get_from (MailConversationItemModel* self);
VALA_EXTERN guint mail_conversation_item_model_get_num_messages (MailConversationItemModel* self);
VALA_EXTERN gboolean mail_conversation_item_model_get_unread (MailConversationItemModel* self);
VALA_EXTERN gboolean mail_conversation_item_model_get_replied_all (MailConversationItemModel* self);
VALA_EXTERN gboolean mail_conversation_item_model_get_replied (MailConversationItemModel* self);
VALA_EXTERN gboolean mail_conversation_item_model_get_forwarded (MailConversationItemModel* self);
VALA_EXTERN gboolean mail_conversation_item_model_get_flagged (MailConversationItemModel* self);
VALA_EXTERN MailConversationListItem* mail_conversation_list_item_new (void);
VALA_EXTERN MailConversationListItem* mail_conversation_list_item_construct (GType object_type);
VALA_EXTERN VirtualizingListBoxRow* virtualizing_list_box_row_new (void);
VALA_EXTERN VirtualizingListBoxRow* virtualizing_list_box_row_construct (GType object_type);
static GObject * mail_conversation_list_item_constructor (GType type,
                                                   guint n_construct_properties,
                                                   GObjectConstructParam * construct_properties);
static void mail_conversation_list_item_finalize (GObject * obj);
static GType mail_conversation_list_item_get_type_once (void);

static inline gpointer
mail_conversation_list_item_get_instance_private (MailConversationListItem* self)
{
	return G_STRUCT_MEMBER_P (self, MailConversationListItem_private_offset);
}

void
mail_conversation_list_item_assign (MailConversationListItem* self,
                                    MailConversationItemModel* data)
{
	GtkLabel* _tmp0_;
	gchar* _tmp1_;
	gchar* _tmp2_;
	gchar* _tmp3_;
	GtkLabel* _tmp4_;
	const gchar* _tmp5_;
	const gchar* _tmp6_;
	gchar* source_label_text = NULL;
	gchar* _tmp7_;
	CamelFolderInfoFlags _tmp8_;
	CamelFolderInfoFlags _tmp9_;
	GtkLabel* _tmp14_;
	const gchar* _tmp15_;
	gchar* _tmp16_;
	gchar* _tmp17_;
	const gchar* _tmp18_;
	const gchar* _tmp19_;
	const gchar* _tmp20_;
	gchar* _tmp21_;
	gchar* _tmp22_;
	guint num_messages = 0U;
	guint _tmp23_;
	guint _tmp24_;
	gchar* _tmp25_ = NULL;
	GtkLabel* _tmp27_;
	GtkLabel* _tmp28_;
	GtkLabel* _tmp29_;
	gboolean _tmp30_;
	gboolean _tmp31_;
	GtkRevealer* _tmp59_;
	gboolean _tmp60_;
	gboolean _tmp61_;
	g_return_if_fail (self != NULL);
	g_return_if_fail (data != NULL);
	_tmp0_ = self->priv->date;
	_tmp1_ = mail_conversation_item_model_get_formatted_date (data);
	_tmp2_ = _tmp1_;
	_tmp3_ = _tmp2_;
	gtk_label_set_label (_tmp0_, _tmp3_);
	_g_free0 (_tmp3_);
	_tmp4_ = self->priv->topic;
	_tmp5_ = mail_conversation_item_model_get_subject (data);
	_tmp6_ = _tmp5_;
	gtk_label_set_label (_tmp4_, _tmp6_);
	_tmp7_ = g_strdup ("");
	source_label_text = _tmp7_;
	_tmp8_ = mail_conversation_item_model_get_folder_info_flags (data);
	_tmp9_ = _tmp8_;
	if (CAMEL_FOLDER_TYPE_SENT == (_tmp9_ & CAMEL_FOLDER_TYPE_MASK)) {
		gchar* _tmp10_;
		gchar* _tmp11_;
		_tmp10_ = mail_conversation_item_model_get_to (data);
		_tmp11_ = _tmp10_;
		_g_free0 (source_label_text);
		source_label_text = _tmp11_;
	} else {
		gchar* _tmp12_;
		gchar* _tmp13_;
		_tmp12_ = mail_conversation_item_model_get_from (data);
		_tmp13_ = _tmp12_;
		_g_free0 (source_label_text);
		source_label_text = _tmp13_;
	}
	_tmp14_ = self->priv->source;
	_tmp15_ = source_label_text;
	_tmp16_ = g_markup_escape_text (_tmp15_, (gssize) -1);
	_tmp17_ = _tmp16_;
	gtk_label_set_label (_tmp14_, _tmp17_);
	_g_free0 (_tmp17_);
	_tmp18_ = source_label_text;
	_tmp19_ = mail_conversation_item_model_get_subject (data);
	_tmp20_ = _tmp19_;
	_tmp21_ = g_markup_printf_escaped ("<b>%s</b>\n%s", _tmp18_, _tmp20_);
	_tmp22_ = _tmp21_;
	gtk_widget_set_tooltip_markup ((GtkWidget*) self, _tmp22_);
	_g_free0 (_tmp22_);
	_tmp23_ = mail_conversation_item_model_get_num_messages (data);
	_tmp24_ = _tmp23_;
	num_messages = _tmp24_;
	if (num_messages > ((guint) 1)) {
		gchar* _tmp26_;
		_tmp26_ = g_strdup_printf ("%u", num_messages);
		_g_free0 (_tmp25_);
		_tmp25_ = _tmp26_;
	} else {
		_g_free0 (_tmp25_);
		_tmp25_ = NULL;
	}
	_tmp27_ = self->priv->messages;
	gtk_label_set_label (_tmp27_, _tmp25_);
	_tmp28_ = self->priv->messages;
	gtk_widget_set_visible ((GtkWidget*) _tmp28_, num_messages > ((guint) 1));
	_tmp29_ = self->priv->messages;
	gtk_widget_set_no_show_all ((GtkWidget*) _tmp29_, num_messages <= ((guint) 1));
	_tmp30_ = mail_conversation_item_model_get_unread (data);
	_tmp31_ = _tmp30_;
	if (_tmp31_) {
		GtkStyleContext* _tmp32_;
		GtkImage* _tmp33_;
		GtkImage* _tmp34_;
		GtkImage* _tmp35_;
		GtkStyleContext* _tmp36_;
		GtkRevealer* _tmp37_;
		GtkLabel* _tmp38_;
		GtkStyleContext* _tmp39_;
		_tmp32_ = gtk_widget_get_style_context ((GtkWidget*) self);
		gtk_style_context_add_class (_tmp32_, "unread-message");
		_tmp33_ = self->priv->status_icon;
		g_object_set (_tmp33_, "icon-name", "mail-unread-symbolic", NULL);
		_tmp34_ = self->priv->status_icon;
		gtk_widget_set_tooltip_text ((GtkWidget*) _tmp34_, _ ("Unread"));
		_tmp35_ = self->priv->status_icon;
		_tmp36_ = gtk_widget_get_style_context ((GtkWidget*) _tmp35_);
		gtk_style_context_add_class (_tmp36_, GRANITE_STYLE_CLASS_ACCENT);
		_tmp37_ = self->priv->status_revealer;
		gtk_revealer_set_reveal_child (_tmp37_, TRUE);
		_tmp38_ = self->priv->source;
		_tmp39_ = gtk_widget_get_style_context ((GtkWidget*) _tmp38_);
		gtk_style_context_add_class (_tmp39_, GRANITE_STYLE_CLASS_ACCENT);
	} else {
		GtkStyleContext* _tmp40_;
		GtkImage* _tmp41_;
		GtkStyleContext* _tmp42_;
		GtkLabel* _tmp43_;
		GtkStyleContext* _tmp44_;
		gboolean _tmp45_ = FALSE;
		gboolean _tmp46_;
		gboolean _tmp47_;
		_tmp40_ = gtk_widget_get_style_context ((GtkWidget*) self);
		gtk_style_context_remove_class (_tmp40_, "unread-message");
		_tmp41_ = self->priv->status_icon;
		_tmp42_ = gtk_widget_get_style_context ((GtkWidget*) _tmp41_);
		gtk_style_context_remove_class (_tmp42_, GRANITE_STYLE_CLASS_ACCENT);
		_tmp43_ = self->priv->source;
		_tmp44_ = gtk_widget_get_style_context ((GtkWidget*) _tmp43_);
		gtk_style_context_remove_class (_tmp44_, GRANITE_STYLE_CLASS_ACCENT);
		_tmp46_ = mail_conversation_item_model_get_replied_all (data);
		_tmp47_ = _tmp46_;
		if (_tmp47_) {
			_tmp45_ = TRUE;
		} else {
			gboolean _tmp48_;
			gboolean _tmp49_;
			_tmp48_ = mail_conversation_item_model_get_replied (data);
			_tmp49_ = _tmp48_;
			_tmp45_ = _tmp49_;
		}
		if (_tmp45_) {
			GtkImage* _tmp50_;
			GtkImage* _tmp51_;
			GtkRevealer* _tmp52_;
			_tmp50_ = self->priv->status_icon;
			g_object_set (_tmp50_, "icon-name", "mail-replied-symbolic", NULL);
			_tmp51_ = self->priv->status_icon;
			gtk_widget_set_tooltip_text ((GtkWidget*) _tmp51_, _ ("Replied"));
			_tmp52_ = self->priv->status_revealer;
			gtk_revealer_set_reveal_child (_tmp52_, TRUE);
		} else {
			gboolean _tmp53_;
			gboolean _tmp54_;
			_tmp53_ = mail_conversation_item_model_get_forwarded (data);
			_tmp54_ = _tmp53_;
			if (_tmp54_) {
				GtkImage* _tmp55_;
				GtkImage* _tmp56_;
				GtkRevealer* _tmp57_;
				_tmp55_ = self->priv->status_icon;
				g_object_set (_tmp55_, "icon-name", "mail-forwarded-symbolic", NULL);
				_tmp56_ = self->priv->status_icon;
				gtk_widget_set_tooltip_text ((GtkWidget*) _tmp56_, _ ("Forwarded"));
				_tmp57_ = self->priv->status_revealer;
				gtk_revealer_set_reveal_child (_tmp57_, TRUE);
			} else {
				GtkRevealer* _tmp58_;
				_tmp58_ = self->priv->status_revealer;
				gtk_revealer_set_reveal_child (_tmp58_, FALSE);
			}
		}
	}
	_tmp59_ = self->priv->flagged_icon_revealer;
	_tmp60_ = mail_conversation_item_model_get_flagged (data);
	_tmp61_ = _tmp60_;
	gtk_revealer_set_reveal_child (_tmp59_, _tmp61_);
	_g_free0 (_tmp25_);
	_g_free0 (source_label_text);
}

MailConversationListItem*
mail_conversation_list_item_construct (GType object_type)
{
	MailConversationListItem * self = NULL;
	self = (MailConversationListItem*) virtualizing_list_box_row_construct (object_type);
	return self;
}

MailConversationListItem*
mail_conversation_list_item_new (void)
{
	return mail_conversation_list_item_construct (MAIL_TYPE_CONVERSATION_LIST_ITEM);
}

static GObject *
mail_conversation_list_item_constructor (GType type,
                                         guint n_construct_properties,
                                         GObjectConstructParam * construct_properties)
{
	GObject * obj;
	GObjectClass * parent_class;
	MailConversationListItem * self;
	GtkImage* _tmp0_;
	GtkRevealer* _tmp1_;
	GtkRevealer* _tmp2_;
	GtkImage* _tmp3_;
	GtkImage* flagged_icon = NULL;
	GtkImage* _tmp4_;
	GtkRevealer* _tmp5_;
	GtkRevealer* _tmp6_;
	GtkImage* _tmp7_;
	GtkLabel* _tmp8_ = NULL;
	GtkLabel* _tmp9_;
	GtkStyleContext* _tmp10_;
	GtkLabel* _tmp11_ = NULL;
	GtkStyleContext* messages_style = NULL;
	GtkLabel* _tmp12_;
	GtkStyleContext* _tmp13_;
	GtkStyleContext* _tmp14_;
	GtkStyleContext* _tmp15_;
	GtkLabel* _tmp16_ = NULL;
	GtkLabel* _tmp17_ = NULL;
	GtkLabel* _tmp18_;
	GtkStyleContext* _tmp19_;
	GtkGrid* grid = NULL;
	GtkGrid* _tmp20_ = NULL;
	GtkGrid* _tmp21_;
	GtkRevealer* _tmp22_;
	GtkGrid* _tmp23_;
	GtkRevealer* _tmp24_;
	GtkGrid* _tmp25_;
	GtkLabel* _tmp26_;
	GtkGrid* _tmp27_;
	GtkLabel* _tmp28_;
	GtkGrid* _tmp29_;
	GtkLabel* _tmp30_;
	GtkGrid* _tmp31_;
	GtkLabel* _tmp32_;
	GtkStyleContext* _tmp33_;
	GtkGrid* _tmp34_;
	parent_class = G_OBJECT_CLASS (mail_conversation_list_item_parent_class);
	obj = parent_class->constructor (type, n_construct_properties, construct_properties);
	self = G_TYPE_CHECK_INSTANCE_CAST (obj, MAIL_TYPE_CONVERSATION_LIST_ITEM, MailConversationListItem);
	_tmp0_ = (GtkImage*) gtk_image_new_from_icon_name ("mail-unread-symbolic", (GtkIconSize) GTK_ICON_SIZE_MENU);
	g_object_ref_sink (_tmp0_);
	_g_object_unref0 (self->priv->status_icon);
	self->priv->status_icon = _tmp0_;
	_tmp1_ = (GtkRevealer*) gtk_revealer_new ();
	g_object_ref_sink (_tmp1_);
	_g_object_unref0 (self->priv->status_revealer);
	self->priv->status_revealer = _tmp1_;
	_tmp2_ = self->priv->status_revealer;
	_tmp3_ = self->priv->status_icon;
	gtk_container_add ((GtkContainer*) _tmp2_, (GtkWidget*) _tmp3_);
	_tmp4_ = (GtkImage*) gtk_image_new_from_icon_name ("starred-symbolic", (GtkIconSize) GTK_ICON_SIZE_MENU);
	g_object_ref_sink (_tmp4_);
	flagged_icon = _tmp4_;
	_tmp5_ = (GtkRevealer*) gtk_revealer_new ();
	g_object_ref_sink (_tmp5_);
	_g_object_unref0 (self->priv->flagged_icon_revealer);
	self->priv->flagged_icon_revealer = _tmp5_;
	_tmp6_ = self->priv->flagged_icon_revealer;
	_tmp7_ = flagged_icon;
	gtk_container_add ((GtkContainer*) _tmp6_, (GtkWidget*) _tmp7_);
	_tmp8_ = (GtkLabel*) gtk_label_new (NULL);
	gtk_widget_set_hexpand ((GtkWidget*) _tmp8_, TRUE);
	gtk_label_set_ellipsize (_tmp8_, PANGO_ELLIPSIZE_END);
	gtk_label_set_use_markup (_tmp8_, TRUE);
	gtk_label_set_xalign (_tmp8_, (gfloat) 0);
	g_object_ref_sink (_tmp8_);
	_g_object_unref0 (self->priv->source);
	self->priv->source = _tmp8_;
	_tmp9_ = self->priv->source;
	_tmp10_ = gtk_widget_get_style_context ((GtkWidget*) _tmp9_);
	gtk_style_context_add_class (_tmp10_, GRANITE_STYLE_CLASS_H3_LABEL);
	_tmp11_ = (GtkLabel*) gtk_label_new (NULL);
	gtk_widget_set_halign ((GtkWidget*) _tmp11_, GTK_ALIGN_END);
	g_object_ref_sink (_tmp11_);
	_g_object_unref0 (self->priv->messages);
	self->priv->messages = _tmp11_;
	_tmp12_ = self->priv->messages;
	_tmp13_ = gtk_widget_get_style_context ((GtkWidget*) _tmp12_);
	messages_style = _tmp13_;
	_tmp14_ = messages_style;
	gtk_style_context_add_class (_tmp14_, GRANITE_STYLE_CLASS_BADGE);
	_tmp15_ = messages_style;
	gtk_style_context_add_class (_tmp15_, GTK_STYLE_CLASS_FLAT);
	_tmp16_ = (GtkLabel*) gtk_label_new (NULL);
	gtk_widget_set_hexpand ((GtkWidget*) _tmp16_, TRUE);
	gtk_label_set_ellipsize (_tmp16_, PANGO_ELLIPSIZE_END);
	gtk_label_set_xalign (_tmp16_, (gfloat) 0);
	g_object_ref_sink (_tmp16_);
	_g_object_unref0 (self->priv->topic);
	self->priv->topic = _tmp16_;
	_tmp17_ = (GtkLabel*) gtk_label_new (NULL);
	gtk_widget_set_halign ((GtkWidget*) _tmp17_, GTK_ALIGN_END);
	g_object_ref_sink (_tmp17_);
	_g_object_unref0 (self->priv->date);
	self->priv->date = _tmp17_;
	_tmp18_ = self->priv->date;
	_tmp19_ = gtk_widget_get_style_context ((GtkWidget*) _tmp18_);
	gtk_style_context_add_class (_tmp19_, GTK_STYLE_CLASS_DIM_LABEL);
	_tmp20_ = (GtkGrid*) gtk_grid_new ();
	g_object_set ((GtkWidget*) _tmp20_, "margin", 12, NULL);
	gtk_grid_set_column_spacing (_tmp20_, 12);
	gtk_grid_set_row_spacing (_tmp20_, 6);
	g_object_ref_sink (_tmp20_);
	grid = _tmp20_;
	_tmp21_ = grid;
	_tmp22_ = self->priv->status_revealer;
	gtk_grid_attach (_tmp21_, (GtkWidget*) _tmp22_, 0, 0, 1, 1);
	_tmp23_ = grid;
	_tmp24_ = self->priv->flagged_icon_revealer;
	gtk_grid_attach (_tmp23_, (GtkWidget*) _tmp24_, 0, 1, 1, 1);
	_tmp25_ = grid;
	_tmp26_ = self->priv->source;
	gtk_grid_attach (_tmp25_, (GtkWidget*) _tmp26_, 1, 0, 1, 1);
	_tmp27_ = grid;
	_tmp28_ = self->priv->date;
	gtk_grid_attach (_tmp27_, (GtkWidget*) _tmp28_, 2, 0, 2, 1);
	_tmp29_ = grid;
	_tmp30_ = self->priv->topic;
	gtk_grid_attach (_tmp29_, (GtkWidget*) _tmp30_, 1, 1, 2, 1);
	_tmp31_ = grid;
	_tmp32_ = self->priv->messages;
	gtk_grid_attach (_tmp31_, (GtkWidget*) _tmp32_, 3, 1, 1, 1);
	_tmp33_ = gtk_widget_get_style_context ((GtkWidget*) self);
	gtk_style_context_add_class (_tmp33_, "conversation-list-item");
	_tmp34_ = grid;
	gtk_container_add ((GtkContainer*) self, (GtkWidget*) _tmp34_);
	gtk_widget_show_all ((GtkWidget*) self);
	_g_object_unref0 (grid);
	_g_object_unref0 (flagged_icon);
	return obj;
}

static void
mail_conversation_list_item_class_init (MailConversationListItemClass * klass,
                                        gpointer klass_data)
{
	mail_conversation_list_item_parent_class = g_type_class_peek_parent (klass);
	g_type_class_adjust_private_offset (klass, &MailConversationListItem_private_offset);
	G_OBJECT_CLASS (klass)->constructor = mail_conversation_list_item_constructor;
	G_OBJECT_CLASS (klass)->finalize = mail_conversation_list_item_finalize;
}

static void
mail_conversation_list_item_instance_init (MailConversationListItem * self,
                                           gpointer klass)
{
	self->priv = mail_conversation_list_item_get_instance_private (self);
}

static void
mail_conversation_list_item_finalize (GObject * obj)
{
	MailConversationListItem * self;
	self = G_TYPE_CHECK_INSTANCE_CAST (obj, MAIL_TYPE_CONVERSATION_LIST_ITEM, MailConversationListItem);
	_g_object_unref0 (self->priv->status_icon);
	_g_object_unref0 (self->priv->date);
	_g_object_unref0 (self->priv->messages);
	_g_object_unref0 (self->priv->source);
	_g_object_unref0 (self->priv->topic);
	_g_object_unref0 (self->priv->flagged_icon_revealer);
	_g_object_unref0 (self->priv->status_revealer);
	G_OBJECT_CLASS (mail_conversation_list_item_parent_class)->finalize (obj);
}

static GType
mail_conversation_list_item_get_type_once (void)
{
	static const GTypeInfo g_define_type_info = { sizeof (MailConversationListItemClass), (GBaseInitFunc) NULL, (GBaseFinalizeFunc) NULL, (GClassInitFunc) mail_conversation_list_item_class_init, (GClassFinalizeFunc) NULL, NULL, sizeof (MailConversationListItem), 0, (GInstanceInitFunc) mail_conversation_list_item_instance_init, NULL };
	GType mail_conversation_list_item_type_id;
	mail_conversation_list_item_type_id = g_type_register_static (TYPE_VIRTUALIZING_LIST_BOX_ROW, "MailConversationListItem", &g_define_type_info, 0);
	MailConversationListItem_private_offset = g_type_add_instance_private (mail_conversation_list_item_type_id, sizeof (MailConversationListItemPrivate));
	return mail_conversation_list_item_type_id;
}

GType
mail_conversation_list_item_get_type (void)
{
	static volatile gsize mail_conversation_list_item_type_id__once = 0;
	if (g_once_init_enter (&mail_conversation_list_item_type_id__once)) {
		GType mail_conversation_list_item_type_id;
		mail_conversation_list_item_type_id = mail_conversation_list_item_get_type_once ();
		g_once_init_leave (&mail_conversation_list_item_type_id__once, mail_conversation_list_item_type_id);
	}
	return mail_conversation_list_item_type_id__once;
}

